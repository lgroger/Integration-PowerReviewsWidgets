define(["modules/jquery-mozu","modules/api","modules/models-cart","hyprlivecontext","underscore"],function(e,t,n,o,a){window.paypalCheckoutReady=function(){var t=o.locals.siteContext,c=a.findWhere(t.checkoutSettings.externalPaymentWorkflowSettings,{name:"PayPalExpress2"}),i=a.findWhere(c.credentials,{apiName:"merchantAccountId"}),l=a.findWhere(c.credentials,{apiName:"environment"}),r=n.Cart.fromCurrent().id,u=window.location.href.indexOf("cart")>0;window.paypal.checkout.setup(i.value,{environment:l.value,click:function(t){t.preventDefault(),window.paypal.checkout.initXO(),e.ajax({url:"../paypal/token?id="+r+"&isCart="+u+(document.URL.split("?")[1]?"&"+document.URL.split("?")[1].replace("id="+r,"").replace("&&","&"):""),type:"GET",async:!0,success:function(e){var t=window.paypal.checkout.urlPrefix+e.token;window.paypal.checkout.startFlow(t)},error:function(e){console.log("Error in ajax post "+e.statusText),window.paypal.checkout.closeFlow()}})},button:["btn_xpressPaypal"]})},e.getScript("//www.paypalobjects.com/api/checkout.js").done(function(){}).fail(function(e){console.log(e)})});