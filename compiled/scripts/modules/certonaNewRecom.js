window.recommendedproducts=null;var certonaRecommendations=function(e){window.recommendedproducts=e,require(["modules/jquery-mozu","underscore","hyprlive","modules/backbone-mozu","modules/api","modules/models-product","vendor/wishlist","modules/models-faceting"],function(e,o,s,r,n,t){var c=r.MozuView.extend({templateName:"modules/product/pdp-recommended-products",render:function(){r.MozuView.prototype.render.call(this),e(".echi-shi-related-products-slider .owl-next, .echi-shi-products_slider .owl-prev").html(""),e(".pdp-related-products .echi-shi-related-products-slider .owl-carousel").owlCarousel({loop:!0,nav:!0,responsive:{0:{items:2},600:{items:2},1e3:{items:4}}})}}),d=function(o,s,r){var d="/api/commerce/catalog/storefront/productsearch/search/?filter="+o+"&pageSize=200";n.request("GET",d).then(function(o){var n=new t.ProductCollection(o);if(s){if(s){var d=new c({el:e("#recommended_products_slot_cart"),model:n});d.render()}}else{for(var l,m=[],i=[],a=0;a<r.resonance.schemes.length;a++){if("product1_rr"===r.resonance.schemes[a].scheme)for(var h=0;h<r.resonance.schemes[a].items.length;h++)l=n.get("items").where({productCode:r.resonance.schemes[a].items[h].id}),l&&l.length>0&&m.push(l[0].apiModel.data);if("product2_rr"===r.resonance.schemes[a].scheme)for(var u=0;u<r.resonance.schemes[a].items.length;u++)l=n.get("items").where({productCode:r.resonance.schemes[a].items[u].id}),l&&l.length>0&&i.push(l[0].apiModel.data)}if(m.length>0){var p=new c({el:e("#recommended_products_slot_1"),model:new t.ProductCollection({items:m})});p.render(),e(".recom_slot-heading_1").show()}if(i.length>0){n.set("items",i);var g=new c({el:e("#recommended_products_slot_2"),model:new t.ProductCollection({items:i})});g.render(),e(".recom_slot-heading_2").show()}if(0===m.length){var f=new c({el:e("#recommended_products_slot"),model:n});f.render()}}})},l=require.mozuData("pagecontext"),m=(l.pageType,0);globalNameSpace.callRecomm=function(e){if(console.log("CallBackFunction Trigger"),e){for(var o,s,r,n=[],t=[],c=0;c<e.resonance.schemes.length;c++)if("addtocart1_rr"===e.resonance.schemes[c].scheme){if(r=!0,"yes"===e.resonance.schemes[c].display){s=e.resonance.schemes[c].items.length;for(var l=0;l<e.resonance.schemes[c].items.length;l++)o=e.resonance.schemes[c].items[l].id,t[l+c*e.resonance.schemes[c].items.length]=o}}else if(r=!1,"yes"===e.resonance.schemes[c].display){s=e.resonance.schemes[c].items.length;for(var i=0;i<e.resonance.schemes[c].items.length;i++)o=e.resonance.schemes[c].items[i].id,n[i+c*e.resonance.schemes[c].items.length]=o}for(var a="productCode eq ",h=0;h<n.length;h++)a+=h<n.length-1?n[h]+" or productCode eq ":n[h];if(0===t.length&&!r&&n.length>=1)d(a,0,e);else if(r&&0===n.length&&t.length>=1){for(var u="productCode eq ",p=0;p<t.length;p++)u+=p<t.length-1?t[p]+" or productCode eq ":t[p];d(u,1,e),m=0,t=[],r=!1}}},setTimeout(function(){globalNameSpace.callRecomm(window.recommendedproducts)},500)})};