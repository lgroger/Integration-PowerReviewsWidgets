var recommendedproducts=null,certonaRecommendations=function(e){recommendedproducts=e,require(["modules/jquery-mozu","underscore","hyprlive","modules/backbone-mozu","hyprlivecontext","modules/editable-view","modules/preserve-element-through-render","modules/api","modules/models-product","vendor/wishlist","modules/models-faceting"],function(e,o,r,s,t,n,c,i,l,d,a){function m(){e(".trigger-login").trigger("click"),e("#cboxOverlay").show(),e("#mz-quick-view-container").fadeOut(350),e("#mz-quick-view-container").empty()}var h=s.MozuView.extend({templateName:"modules/product/pdp-recommended-products",render:function(){s.MozuView.prototype.render.call(this),e(".echi-shi-related-products-slider .owl-next, .echi-shi-products_slider .owl-prev").html(""),e(".pdp-related-products .echi-shi-related-products-slider .owl-carousel").owlCarousel({loop:!0,nav:!0,responsive:{0:{items:2},600:{items:2},1e3:{items:4}}});var o=require.mozuData("facetedproducts"),r=new a.FacetedProductCollection(o);e(".wishlist-icon > a, .wishlist-icon-tablet>a").click(function(){if(require.mozuData("user").isAnonymous)m();else{var o=e(this).attr("id"),s=r.get("items").where({productCode:o});d.initoWishlist(s[0])}})}}),u=function(o,r,s){var t="/api/commerce/catalog/storefront/productsearch/search/?filter="+o+"&pageSize=200";i.request("GET",t).then(function(o){var t=new l.ProductCollection(o);if(r){if(r){var n=new h({el:e("#recommended_products_slot_cart"),model:t});n.render()}}else{for(var c,i=[],d=[],a=0;a<s.resonance.schemes.length;a++){if("product1_rr"===s.resonance.schemes[a].scheme)for(var m=0;m<s.resonance.schemes[a].items.length;m++)c=t.get("items").where({productCode:s.resonance.schemes[a].items[m].id}),c&&c.length>0&&i.push(c[0].apiModel.data);if("product2_rr"===s.resonance.schemes[a].scheme)for(var u=0;u<s.resonance.schemes[a].items.length;u++)c=t.get("items").where({productCode:s.resonance.schemes[a].items[u].id}),c&&c.length>0&&d.push(c[0].apiModel.data)}if(i.length>0){var p=new h({el:e("#recommended_products_slot_1"),model:new l.ProductCollection({items:i})});p.render(),e(".recom_slot-heading_1").show()}if(d.length>0){t.set("items",d);var g=new h({el:e("#recommended_products_slot_2"),model:new l.ProductCollection({items:d})});g.render(),e(".recom_slot-heading_2").show()}if(0===i.length){var f=new h({el:e("#recommended_products_slot"),model:t});f.render()}}})},p=require.mozuData("pagecontext"),g=(p.pageType,0);globalNameSpace.callRecomm=function(e){if(console.log("CallBackFunction Trigger"),e){for(var o,r,s,t=[],n=[],c=0;c<e.resonance.schemes.length;c++)if("addtocart1_rr"===e.resonance.schemes[c].scheme){if(s=!0,"yes"===e.resonance.schemes[c].display){r=e.resonance.schemes[c].items.length;for(var i=0;i<e.resonance.schemes[c].items.length;i++)o=e.resonance.schemes[c].items[i].id,n[i+c*e.resonance.schemes[c].items.length]=o}}else if(s=!1,"yes"===e.resonance.schemes[c].display){r=e.resonance.schemes[c].items.length;for(var l=0;l<e.resonance.schemes[c].items.length;l++)o=e.resonance.schemes[c].items[l].id,t[l+c*e.resonance.schemes[c].items.length]=o}for(var d="productCode eq ",a=0;a<t.length;a++)d+=a<t.length-1?t[a]+" or productCode eq ":t[a];if(0===n.length&&!s&&t.length>=1)u(d,0,e);else if(s&&0===t.length&&n.length>=1){for(var m="productCode eq ",h=0;h<n.length;h++)m+=h<n.length-1?n[h]+" or productCode eq ":n[h];u(m,1,e),g=0,n=[],s=!1}}},setTimeout(function(){globalNameSpace.callRecomm(recommendedproducts)},500)})};