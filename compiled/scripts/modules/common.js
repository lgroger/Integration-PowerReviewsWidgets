//     Underscore.js 1.6.0
//     http://underscorejs.org
//     (c) 2009-2014 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
//     Underscore may be freely distributed under the MIT license.

//     (c) 2010-2014 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
//     Backbone may be freely distributed under the MIT license.
//     For all details and documentation:
//     http://backbonejs.org

// Copyright (c) 2011-2013 Thomas Pedersen

// Documentation and full license available at:

/*!
 * jQuery Cookie Plugin v1.4.1
 * https://github.com/carhartl/jquery-cookie
 *
 * Copyright 2013 Klaus Hartl
 * Released under the MIT license
 */

/* ========================================================================
 * Bootstrap: tooltip.js v3.2.0
 * http://getbootstrap.com/javascript/#tooltip
 * Inspired by the original jQuery.tipsy by Jason Frame
 * ========================================================================
 * Copyright 2011-2014 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: popover.js v3.2.0
 * http://getbootstrap.com/javascript/#popovers
 * ========================================================================
 * Copyright 2011-2014 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/*! http://mths.be/placeholder v2.1.0 by @mathias */

/* ========================================================================
 * Bootstrap: affix.js v3.2.0
 * http://getbootstrap.com/javascript/#affix
 * ========================================================================
 * Copyright 2011-2014 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: scrollspy.js v3.2.0
 * http://getbootstrap.com/javascript/#scrollspy
 * ========================================================================
 * Copyright 2011-2014 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/*!
 * typeahead.js 0.10.4
 * https://github.com/twitter/typeahead.js
 * Copyright 2013-2014 Twitter, Inc. and other contributors; Licensed MIT
 */

define("modules/common",function(){}),define("modules/api",["sdk","jquery","hyprlive"],function(t,e,n){var i=require.mozuData("apicontext");t.setServiceUrls(i.urls);var r=t.Store(i.headers).api();return(n.getThemeSetting("useDebugScripts")||require.mozuData("pagecontext").isDebugMode)&&r.on("error",function(t,e,n){var i="Error communicating with Mozu web services";n&&n.url&&(i+=" at "+n.url);var r=e&&e.getResponseHeader&&e.getResponseHeader("x-vol-correlation");r&&(i+=" --- Correlation ID: "+r),window&&window.console&&console.error(i,t,e)}),r}),function(){var t=this,e=t._,n={},i=Array.prototype,r=Object.prototype,s=Function.prototype,o=i.push,a=i.slice,u=i.concat,l=r.toString,c=r.hasOwnProperty,d=i.forEach,h=i.map,p=i.reduce,f=i.reduceRight,g=i.filter,m=i.every,v=i.some,y=i.indexOf,b=i.lastIndexOf,w=Array.isArray,x=Object.keys,C=s.bind,_=function(t){return t instanceof _?t:this instanceof _?(this._wrapped=t,void 0):new _(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=_),exports._=_):t._=_,_.VERSION="1.6.0";var F=_.each=_.forEach=function(t,e,i){if(null==t)return t;if(d&&t.forEach===d)t.forEach(e,i);else if(t.length===+t.length){for(var r=0,s=t.length;s>r;r++)if(e.call(i,t[r],r,t)===n)return}else for(var o=_.keys(t),r=0,s=o.length;s>r;r++)if(e.call(i,t[o[r]],o[r],t)===n)return;return t};_.map=_.collect=function(t,e,n){var i=[];return null==t?i:h&&t.map===h?t.map(e,n):(F(t,function(t,r,s){i.push(e.call(n,t,r,s))}),i)};var S="Reduce of empty array with no initial value";_.reduce=_.foldl=_.inject=function(t,e,n,i){var r=arguments.length>2;if(null==t&&(t=[]),p&&t.reduce===p)return i&&(e=_.bind(e,i)),r?t.reduce(e,n):t.reduce(e);if(F(t,function(t,s,o){r?n=e.call(i,n,t,s,o):(n=t,r=!0)}),!r)throw new TypeError(S);return n},_.reduceRight=_.foldr=function(t,e,n,i){var r=arguments.length>2;if(null==t&&(t=[]),f&&t.reduceRight===f)return i&&(e=_.bind(e,i)),r?t.reduceRight(e,n):t.reduceRight(e);var s=t.length;if(s!==+s){var o=_.keys(t);s=o.length}if(F(t,function(a,u,l){u=o?o[--s]:--s,r?n=e.call(i,n,t[u],u,l):(n=t[u],r=!0)}),!r)throw new TypeError(S);return n},_.find=_.detect=function(t,e,n){var i;return T(t,function(t,r,s){return e.call(n,t,r,s)?(i=t,!0):void 0}),i},_.filter=_.select=function(t,e,n){var i=[];return null==t?i:g&&t.filter===g?t.filter(e,n):(F(t,function(t,r,s){e.call(n,t,r,s)&&i.push(t)}),i)},_.reject=function(t,e,n){return _.filter(t,function(t,i,r){return!e.call(n,t,i,r)},n)},_.every=_.all=function(t,e,i){e||(e=_.identity);var r=!0;return null==t?r:m&&t.every===m?t.every(e,i):(F(t,function(t,s,o){return(r=r&&e.call(i,t,s,o))?void 0:n}),!!r)};var T=_.some=_.any=function(t,e,i){e||(e=_.identity);var r=!1;return null==t?r:v&&t.some===v?t.some(e,i):(F(t,function(t,s,o){return r||(r=e.call(i,t,s,o))?n:void 0}),!!r)};_.contains=_.include=function(t,e){return null==t?!1:y&&t.indexOf===y?-1!=t.indexOf(e):T(t,function(t){return t===e})},_.invoke=function(t,e){var n=a.call(arguments,2),i=_.isFunction(e);return _.map(t,function(t){return(i?e:t[e]).apply(t,n)})},_.pluck=function(t,e){return _.map(t,_.property(e))},_.where=function(t,e){return _.filter(t,_.matches(e))},_.findWhere=function(t,e){return _.find(t,_.matches(e))},_.max=function(t,e,n){if(!e&&_.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);var i=-1/0,r=-1/0;return F(t,function(t,s,o){var a=e?e.call(n,t,s,o):t;a>r&&(i=t,r=a)}),i},_.min=function(t,e,n){if(!e&&_.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);var i=1/0,r=1/0;return F(t,function(t,s,o){var a=e?e.call(n,t,s,o):t;r>a&&(i=t,r=a)}),i},_.shuffle=function(t){var e,n=0,i=[];return F(t,function(t){e=_.random(n++),i[n-1]=i[e],i[e]=t}),i},_.sample=function(t,e,n){return null==e||n?(t.length!==+t.length&&(t=_.values(t)),t[_.random(t.length-1)]):_.shuffle(t).slice(0,Math.max(0,e))};var z=function(t){return null==t?_.identity:_.isFunction(t)?t:_.property(t)};_.sortBy=function(t,e,n){return e=z(e),_.pluck(_.map(t,function(t,i,r){return{value:t,index:i,criteria:e.call(n,t,i,r)}}).sort(function(t,e){var n=t.criteria,i=e.criteria;if(n!==i){if(n>i||void 0===n)return 1;if(i>n||void 0===i)return-1}return t.index-e.index}),"value")};var I=function(t){return function(e,n,i){var r={};return n=z(n),F(e,function(s,o){var a=n.call(i,s,o,e);t(r,a,s)}),r}};_.groupBy=I(function(t,e,n){_.has(t,e)?t[e].push(n):t[e]=[n]}),_.indexBy=I(function(t,e,n){t[e]=n}),_.countBy=I(function(t,e){_.has(t,e)?t[e]++:t[e]=1}),_.sortedIndex=function(t,e,n,i){n=z(n);for(var r=n.call(i,e),s=0,o=t.length;o>s;){var a=s+o>>>1;n.call(i,t[a])<r?s=a+1:o=a}return s},_.toArray=function(t){return t?_.isArray(t)?a.call(t):t.length===+t.length?_.map(t,_.identity):_.values(t):[]},_.size=function(t){return null==t?0:t.length===+t.length?t.length:_.keys(t).length},_.first=_.head=_.take=function(t,e,n){return null==t?void 0:null==e||n?t[0]:0>e?[]:a.call(t,0,e)},_.initial=function(t,e,n){return a.call(t,0,t.length-(null==e||n?1:e))},_.last=function(t,e,n){return null==t?void 0:null==e||n?t[t.length-1]:a.call(t,Math.max(t.length-e,0))},_.rest=_.tail=_.drop=function(t,e,n){return a.call(t,null==e||n?1:e)},_.compact=function(t){return _.filter(t,_.identity)};var P=function(t,e,n){return e&&_.every(t,_.isArray)?u.apply(n,t):(F(t,function(t){_.isArray(t)||_.isArguments(t)?e?o.apply(n,t):P(t,e,n):n.push(t)}),n)};_.flatten=function(t,e){return P(t,e,[])},_.without=function(t){return _.difference(t,a.call(arguments,1))},_.partition=function(t,e){var n=[],i=[];return F(t,function(t){(e(t)?n:i).push(t)}),[n,i]},_.uniq=_.unique=function(t,e,n,i){_.isFunction(e)&&(i=n,n=e,e=!1);var r=n?_.map(t,n,i):t,s=[],o=[];return F(r,function(n,i){(e?i&&o[o.length-1]===n:_.contains(o,n))||(o.push(n),s.push(t[i]))}),s},_.union=function(){return _.uniq(_.flatten(arguments,!0))},_.intersection=function(t){var e=a.call(arguments,1);return _.filter(_.uniq(t),function(t){return _.every(e,function(e){return _.contains(e,t)})})},_.difference=function(t){var e=u.apply(i,a.call(arguments,1));return _.filter(t,function(t){return!_.contains(e,t)})},_.zip=function(){for(var t=_.max(_.pluck(arguments,"length").concat(0)),e=new Array(t),n=0;t>n;n++)e[n]=_.pluck(arguments,""+n);return e},_.object=function(t,e){if(null==t)return{};for(var n={},i=0,r=t.length;r>i;i++)e?n[t[i]]=e[i]:n[t[i][0]]=t[i][1];return n},_.indexOf=function(t,e,n){if(null==t)return-1;var i=0,r=t.length;if(n){if("number"!=typeof n)return i=_.sortedIndex(t,e),t[i]===e?i:-1;i=0>n?Math.max(0,r+n):n}if(y&&t.indexOf===y)return t.indexOf(e,n);for(;r>i;i++)if(t[i]===e)return i;return-1},_.lastIndexOf=function(t,e,n){if(null==t)return-1;var i=null!=n;if(b&&t.lastIndexOf===b)return i?t.lastIndexOf(e,n):t.lastIndexOf(e);for(var r=i?n:t.length;r--;)if(t[r]===e)return r;return-1},_.range=function(t,e,n){arguments.length<=1&&(e=t||0,t=0),n=arguments[2]||1;for(var i=Math.max(Math.ceil((e-t)/n),0),r=0,s=new Array(i);i>r;)s[r++]=t,t+=n;return s};var k=function(){};_.bind=function(t,e){var n,i;if(C&&t.bind===C)return C.apply(t,a.call(arguments,1));if(!_.isFunction(t))throw new TypeError;return n=a.call(arguments,2),i=function(){if(!(this instanceof i))return t.apply(e,n.concat(a.call(arguments)));k.prototype=t.prototype;var r=new k;k.prototype=null;var s=t.apply(r,n.concat(a.call(arguments)));return Object(s)===s?s:r}},_.partial=function(t){var e=a.call(arguments,1);return function(){for(var n=0,i=e.slice(),r=0,s=i.length;s>r;r++)i[r]===_&&(i[r]=arguments[n++]);for(;n<arguments.length;)i.push(arguments[n++]);return t.apply(this,i)}},_.bindAll=function(t){var e=a.call(arguments,1);if(0===e.length)throw new Error("bindAll must be passed function names");return F(e,function(e){t[e]=_.bind(t[e],t)}),t},_.memoize=function(t,e){var n={};return e||(e=_.identity),function(){var i=e.apply(this,arguments);return _.has(n,i)?n[i]:n[i]=t.apply(this,arguments)}},_.delay=function(t,e){var n=a.call(arguments,2);return setTimeout(function(){return t.apply(null,n)},e)},_.defer=function(t){return _.delay.apply(_,[t,1].concat(a.call(arguments,1)))},_.throttle=function(t,e,n){var i,r,s,o=null,a=0;n||(n={});var u=function(){a=n.leading===!1?0:_.now(),o=null,s=t.apply(i,r),i=r=null};return function(){var l=_.now();a||n.leading!==!1||(a=l);var c=e-(l-a);return i=this,r=arguments,0>=c?(clearTimeout(o),o=null,a=l,s=t.apply(i,r),i=r=null):o||n.trailing===!1||(o=setTimeout(u,c)),s}},_.debounce=function(t,e,n){var i,r,s,o,a,u=function(){var l=_.now()-o;e>l?i=setTimeout(u,e-l):(i=null,n||(a=t.apply(s,r),s=r=null))};return function(){s=this,r=arguments,o=_.now();var l=n&&!i;return i||(i=setTimeout(u,e)),l&&(a=t.apply(s,r),s=r=null),a}},_.once=function(t){var e,n=!1;return function(){return n?e:(n=!0,e=t.apply(this,arguments),t=null,e)}},_.wrap=function(t,e){return _.partial(e,t)},_.compose=function(){var t=arguments;return function(){for(var e=arguments,n=t.length-1;n>=0;n--)e=[t[n].apply(this,e)];return e[0]}},_.after=function(t,e){return function(){return--t<1?e.apply(this,arguments):void 0}},_.keys=function(t){if(!_.isObject(t))return[];if(x)return x(t);var e=[];for(var n in t)_.has(t,n)&&e.push(n);return e},_.values=function(t){for(var e=_.keys(t),n=e.length,i=new Array(n),r=0;n>r;r++)i[r]=t[e[r]];return i},_.pairs=function(t){for(var e=_.keys(t),n=e.length,i=new Array(n),r=0;n>r;r++)i[r]=[e[r],t[e[r]]];return i},_.invert=function(t){for(var e={},n=_.keys(t),i=0,r=n.length;r>i;i++)e[t[n[i]]]=n[i];return e},_.functions=_.methods=function(t){var e=[];for(var n in t)_.isFunction(t[n])&&e.push(n);return e.sort()},_.extend=function(t){return F(a.call(arguments,1),function(e){if(e)for(var n in e)t[n]=e[n]}),t},_.pick=function(t){var e={},n=u.apply(i,a.call(arguments,1));return F(n,function(n){n in t&&(e[n]=t[n])}),e},_.omit=function(t){var e={},n=u.apply(i,a.call(arguments,1));for(var r in t)_.contains(n,r)||(e[r]=t[r]);return e},_.defaults=function(t){return F(a.call(arguments,1),function(e){if(e)for(var n in e)void 0===t[n]&&(t[n]=e[n])}),t},_.clone=function(t){return _.isObject(t)?_.isArray(t)?t.slice():_.extend({},t):t},_.tap=function(t,e){return e(t),t};var M=function(t,e,n,i){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;t instanceof _&&(t=t._wrapped),e instanceof _&&(e=e._wrapped);var r=l.call(t);if(r!=l.call(e))return!1;switch(r){case"[object String]":return t==String(e);case"[object Number]":return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object RegExp]":return t.source==e.source&&t.global==e.global&&t.multiline==e.multiline&&t.ignoreCase==e.ignoreCase}if("object"!=typeof t||"object"!=typeof e)return!1;for(var s=n.length;s--;)if(n[s]==t)return i[s]==e;var o=t.constructor,a=e.constructor;if(o!==a&&!(_.isFunction(o)&&o instanceof o&&_.isFunction(a)&&a instanceof a)&&"constructor"in t&&"constructor"in e)return!1;n.push(t),i.push(e);var u=0,c=!0;if("[object Array]"==r){if(u=t.length,c=u==e.length)for(;u--&&(c=M(t[u],e[u],n,i)););}else{for(var d in t)if(_.has(t,d)&&(u++,!(c=_.has(e,d)&&M(t[d],e[d],n,i))))break;if(c){for(d in e)if(_.has(e,d)&&!u--)break;c=!u}}return n.pop(),i.pop(),c};_.isEqual=function(t,e){return M(t,e,[],[])},_.isEmpty=function(t){if(null==t)return!0;if(_.isArray(t)||_.isString(t))return 0===t.length;for(var e in t)if(_.has(t,e))return!1;return!0},_.isElement=function(t){return!(!t||1!==t.nodeType)},_.isArray=w||function(t){return"[object Array]"==l.call(t)},_.isObject=function(t){return t===Object(t)},F(["Arguments","Function","String","Number","Date","RegExp"],function(t){_["is"+t]=function(e){return l.call(e)=="[object "+t+"]"}}),_.isArguments(arguments)||(_.isArguments=function(t){return!(!t||!_.has(t,"callee"))}),"function"!=typeof/./&&(_.isFunction=function(t){return"function"==typeof t}),_.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},_.isNaN=function(t){return _.isNumber(t)&&t!=+t},_.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"==l.call(t)},_.isNull=function(t){return null===t},_.isUndefined=function(t){return void 0===t},_.has=function(t,e){return c.call(t,e)},_.noConflict=function(){return t._=e,this},_.identity=function(t){return t},_.constant=function(t){return function(){return t}},_.property=function(t){return function(e){return e[t]}},_.matches=function(t){return function(e){if(e===t)return!0;for(var n in t)if(t[n]!==e[n])return!1;return!0}},_.times=function(t,e,n){for(var i=Array(Math.max(0,t)),r=0;t>r;r++)i[r]=e.call(n,r);return i},_.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},_.now=Date.now||function(){return(new Date).getTime()};var A={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};A.unescape=_.invert(A.escape);var E={escape:new RegExp("["+_.keys(A.escape).join("")+"]","g"),unescape:new RegExp("("+_.keys(A.unescape).join("|")+")","g")};_.each(["escape","unescape"],function(t){_[t]=function(e){return null==e?"":(""+e).replace(E[t],function(e){return A[t][e]})}}),_.result=function(t,e){if(null==t)return void 0;var n=t[e];return _.isFunction(n)?n.call(t):n},_.mixin=function(t){F(_.functions(t),function(e){var n=_[e]=t[e];_.prototype[e]=function(){var t=[this._wrapped];return o.apply(t,arguments),N.call(this,n.apply(_,t))}})};var R=0;_.uniqueId=function(t){var e=++R+"";return t?t+e:e},_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var D=/(.)^/,$={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},q=/\\|'|\r|\n|\t|\u2028|\u2029/g;_.template=function(t,e,n){var i;n=_.defaults({},n,_.templateSettings);var r=new RegExp([(n.escape||D).source,(n.interpolate||D).source,(n.evaluate||D).source].join("|")+"|$","g"),s=0,o="__p+='";t.replace(r,function(e,n,i,r,a){return o+=t.slice(s,a).replace(q,function(t){return"\\"+$[t]}),n&&(o+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),i&&(o+="'+\n((__t=("+i+"))==null?'':__t)+\n'"),r&&(o+="';\n"+r+"\n__p+='"),s=a+e.length,e}),o+="';\n",n.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{i=new Function(n.variable||"obj","_",o)}catch(a){throw a.source=o,a}if(e)return i(e,_);var u=function(t){return i.call(this,t,_)};return u.source="function("+(n.variable||"obj")+"){\n"+o+"}",u},_.chain=function(t){return _(t).chain()};var N=function(t){return this._chain?_(t).chain():t};_.mixin(_),F(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=i[t];_.prototype[t]=function(){var n=this._wrapped;return e.apply(n,arguments),"shift"!=t&&"splice"!=t||0!==n.length||delete n[0],N.call(this,n)}}),F(["concat","join","slice"],function(t){var e=i[t];_.prototype[t]=function(){return N.call(this,e.apply(this._wrapped,arguments))}}),_.extend(_.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),"function"==typeof define&&define.amd&&define("underscore",[],function(){return _})}.call(this),function(t,e){if("function"==typeof define&&define.amd)define("backbone",["underscore","jquery","exports"],function(n,i,r){t.Backbone=e(t,r,n,i)});else if("undefined"!=typeof exports){var n=require("underscore");e(t,exports,n)}else t.Backbone=e(t,{},t._,t.jQuery||t.Zepto||t.ender||t.$)}(this,function(t,e,n,i){{var r=t.Backbone,s=[],o=(s.push,s.slice);s.splice}e.VERSION="1.1.2",e.$=i,e.noConflict=function(){return t.Backbone=r,this},e.emulateHTTP=!1,e.emulateJSON=!1;var a=e.Events={on:function(t,e,n){if(!l(this,"on",t,[e,n])||!e)return this;this._events||(this._events={});var i=this._events[t]||(this._events[t]=[]);return i.push({callback:e,context:n,ctx:n||this}),this},once:function(t,e,i){if(!l(this,"once",t,[e,i])||!e)return this;var r=this,s=n.once(function(){r.off(t,s),e.apply(this,arguments)});return s._callback=e,this.on(t,s,i)},off:function(t,e,i){var r,s,o,a,u,c,d,h;if(!this._events||!l(this,"off",t,[e,i]))return this;if(!t&&!e&&!i)return this._events=void 0,this;for(a=t?[t]:n.keys(this._events),u=0,c=a.length;c>u;u++)if(t=a[u],o=this._events[t]){if(this._events[t]=r=[],e||i)for(d=0,h=o.length;h>d;d++)s=o[d],(e&&e!==s.callback&&e!==s.callback._callback||i&&i!==s.context)&&r.push(s);r.length||delete this._events[t]}return this},trigger:function(t){if(!this._events)return this;var e=o.call(arguments,1);if(!l(this,"trigger",t,e))return this;var n=this._events[t],i=this._events.all;return n&&c(n,e),i&&c(i,arguments),this},stopListening:function(t,e,i){var r=this._listeningTo;if(!r)return this;var s=!e&&!i;i||"object"!=typeof e||(i=this),t&&((r={})[t._listenId]=t);for(var o in r)t=r[o],t.off(e,i,this),(s||n.isEmpty(t._events))&&delete this._listeningTo[o];return this}},u=/\s+/,l=function(t,e,n,i){if(!n)return!0;if("object"==typeof n){for(var r in n)t[e].apply(t,[r,n[r]].concat(i));return!1}if(u.test(n)){for(var s=n.split(u),o=0,a=s.length;a>o;o++)t[e].apply(t,[s[o]].concat(i));return!1}return!0},c=function(t,e){var n,i=-1,r=t.length,s=e[0],o=e[1],a=e[2];switch(e.length){case 0:for(;++i<r;)(n=t[i]).callback.call(n.ctx);return;case 1:for(;++i<r;)(n=t[i]).callback.call(n.ctx,s);return;case 2:for(;++i<r;)(n=t[i]).callback.call(n.ctx,s,o);return;case 3:for(;++i<r;)(n=t[i]).callback.call(n.ctx,s,o,a);return;default:for(;++i<r;)(n=t[i]).callback.apply(n.ctx,e);return}},d={listenTo:"on",listenToOnce:"once"};n.each(d,function(t,e){a[e]=function(e,i,r){var s=this._listeningTo||(this._listeningTo={}),o=e._listenId||(e._listenId=n.uniqueId("l"));return s[o]=e,r||"object"!=typeof i||(r=this),e[t](i,r,this),this}}),a.bind=a.on,a.unbind=a.off,n.extend(e,a);var h=e.Model=function(t,e){var i=t||{};e||(e={}),this.cid=n.uniqueId("c"),this.attributes={},e.collection&&(this.collection=e.collection),e.parse&&(i=this.parse(i,e)||{}),i=n.defaults({},i,n.result(this,"defaults")),this.set(i,e),this.changed={},this.initialize.apply(this,arguments)};n.extend(h.prototype,a,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(){return n.clone(this.attributes)},sync:function(){return e.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return n.escape(this.get(t))},has:function(t){return null!=this.get(t)},set:function(t,e,i){var r,s,o,a,u,l,c,d;if(null==t)return this;if("object"==typeof t?(s=t,i=e):(s={})[t]=e,i||(i={}),!this._validate(s,i))return!1;o=i.unset,u=i.silent,a=[],l=this._changing,this._changing=!0,l||(this._previousAttributes=n.clone(this.attributes),this.changed={}),d=this.attributes,c=this._previousAttributes,this.idAttribute in s&&(this.id=s[this.idAttribute]);for(r in s)e=s[r],n.isEqual(d[r],e)||a.push(r),n.isEqual(c[r],e)?delete this.changed[r]:this.changed[r]=e,o?delete d[r]:d[r]=e;if(!u){a.length&&(this._pending=i);for(var h=0,p=a.length;p>h;h++)this.trigger("change:"+a[h],this,d[a[h]],i)}if(l)return this;if(!u)for(;this._pending;)i=this._pending,this._pending=!1,this.trigger("change",this,i);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,n.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var i in this.attributes)e[i]=void 0;return this.set(e,n.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!n.isEmpty(this.changed):n.has(this.changed,t)},changedAttributes:function(t){if(!t)return this.hasChanged()?n.clone(this.changed):!1;var e,i=!1,r=this._changing?this._previousAttributes:this.attributes;for(var s in t)n.isEqual(r[s],e=t[s])||((i||(i={}))[s]=e);return i},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return n.clone(this._previousAttributes)},fetch:function(t){t=t?n.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=this,i=t.success;return t.success=function(n){return e.set(e.parse(n,t),t)?(i&&i(e,n,t),e.trigger("sync",e,n,t),void 0):!1},q(this,t),this.sync("read",this,t)},save:function(t,e,i){var r,s,o,a=this.attributes;if(null==t||"object"==typeof t?(r=t,i=e):(r={})[t]=e,i=n.extend({validate:!0},i),r&&!i.wait){if(!this.set(r,i))return!1}else if(!this._validate(r,i))return!1;r&&i.wait&&(this.attributes=n.extend({},a,r)),void 0===i.parse&&(i.parse=!0);var u=this,l=i.success;return i.success=function(t){u.attributes=a;var e=u.parse(t,i);return i.wait&&(e=n.extend(r||{},e)),n.isObject(e)&&!u.set(e,i)?!1:(l&&l(u,t,i),u.trigger("sync",u,t,i),void 0)},q(this,i),s=this.isNew()?"create":i.patch?"patch":"update","patch"===s&&(i.attrs=r),o=this.sync(s,this,i),r&&i.wait&&(this.attributes=a),o},destroy:function(t){t=t?n.clone(t):{};var e=this,i=t.success,r=function(){e.trigger("destroy",e,e.collection,t)};if(t.success=function(n){(t.wait||e.isNew())&&r(),i&&i(e,n,t),e.isNew()||e.trigger("sync",e,n,t)},this.isNew())return t.success(),!1;q(this,t);var s=this.sync("delete",this,t);return t.wait||r(),s},url:function(){var t=n.result(this,"urlRoot")||n.result(this.collection,"url")||$();return this.isNew()?t:t.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(t){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(t){return this._validate({},n.extend(t||{},{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=n.extend({},this.attributes,t);var i=this.validationError=this.validate(t,e)||null;return i?(this.trigger("invalid",this,i,n.extend(e,{validationError:i})),!1):!0}});var p=["keys","values","pairs","invert","pick","omit"];n.each(p,function(t){h.prototype[t]=function(){var e=o.call(arguments);return e.unshift(this.attributes),n[t].apply(n,e)}});var f=e.Collection=function(t,e){e||(e={}),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,n.extend({silent:!0},e))},g={add:!0,remove:!0,merge:!0},m={add:!0,remove:!1};n.extend(f.prototype,a,{model:h,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return e.sync.apply(this,arguments)},add:function(t,e){return this.set(t,n.extend({merge:!1},e,m))},remove:function(t,e){var i=!n.isArray(t);t=i?[t]:n.clone(t),e||(e={});var r,s,o,a;for(r=0,s=t.length;s>r;r++)a=t[r]=this.get(t[r]),a&&(delete this._byId[a.id],delete this._byId[a.cid],o=this.indexOf(a),this.models.splice(o,1),this.length--,e.silent||(e.index=o,a.trigger("remove",a,this,e)),this._removeReference(a,e));return i?t[0]:t},set:function(t,e){e=n.defaults({},e,g),e.parse&&(t=this.parse(t,e));var i=!n.isArray(t);t=i?t?[t]:[]:n.clone(t);var r,s,o,a,u,l,c,d=e.at,p=this.model,f=this.comparator&&null==d&&e.sort!==!1,m=n.isString(this.comparator)?this.comparator:null,v=[],y=[],b={},w=e.add,x=e.merge,C=e.remove,_=!f&&w&&C?[]:!1;for(r=0,s=t.length;s>r;r++){if(u=t[r]||{},o=u instanceof h?a=u:u[p.prototype.idAttribute||"id"],l=this.get(o))C&&(b[l.cid]=!0),x&&(u=u===a?a.attributes:u,e.parse&&(u=l.parse(u,e)),l.set(u,e),f&&!c&&l.hasChanged(m)&&(c=!0)),t[r]=l;else if(w){if(a=t[r]=this._prepareModel(u,e),!a)continue;v.push(a),this._addReference(a,e)}a=l||a,!_||!a.isNew()&&b[a.id]||_.push(a),b[a.id]=!0}if(C){for(r=0,s=this.length;s>r;++r)b[(a=this.models[r]).cid]||y.push(a);y.length&&this.remove(y,e)}if(v.length||_&&_.length)if(f&&(c=!0),this.length+=v.length,null!=d)for(r=0,s=v.length;s>r;r++)this.models.splice(d+r,0,v[r]);else{_&&(this.models.length=0);var F=_||v;for(r=0,s=F.length;s>r;r++)this.models.push(F[r])}if(c&&this.sort({silent:!0}),!e.silent){for(r=0,s=v.length;s>r;r++)(a=v[r]).trigger("add",a,this,e);(c||_&&_.length)&&this.trigger("sort",this,e)}return i?t[0]:t},reset:function(t,e){e||(e={});for(var i=0,r=this.models.length;r>i;i++)this._removeReference(this.models[i],e);return e.previousModels=this.models,this._reset(),t=this.add(t,n.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),t},push:function(t,e){return this.add(t,n.extend({at:this.length},e))},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t),e},unshift:function(t,e){return this.add(t,n.extend({at:0},e))},shift:function(t){var e=this.at(0);return this.remove(e,t),e},slice:function(){return o.apply(this.models,arguments)},get:function(t){return null==t?void 0:this._byId[t]||this._byId[t.id]||this._byId[t.cid]},at:function(t){return this.models[t]},where:function(t,e){return n.isEmpty(t)?e?void 0:[]:this[e?"find":"filter"](function(e){for(var n in t)if(t[n]!==e.get(n))return!1;return!0})},findWhere:function(t){return this.where(t,!0)},sort:function(t){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return t||(t={}),n.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(n.bind(this.comparator,this)),t.silent||this.trigger("sort",this,t),this},pluck:function(t){return n.invoke(this.models,"get",t)},fetch:function(t){t=t?n.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=t.success,i=this;return t.success=function(n){var r=t.reset?"reset":"set";i[r](n,t),e&&e(i,n,t),i.trigger("sync",i,n,t)},q(this,t),this.sync("read",this,t)},create:function(t,e){if(e=e?n.clone(e):{},!(t=this._prepareModel(t,e)))return!1;e.wait||this.add(t,e);var i=this,r=e.success;return e.success=function(t,n){e.wait&&i.add(t,e),r&&r(t,n,e)},t.save(null,e),t},parse:function(t){return t},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){if(t instanceof h)return t;e=e?n.clone(e):{},e.collection=this;var i=new this.model(t,e);return i.validationError?(this.trigger("invalid",this,i.validationError,e),!1):i},_addReference:function(t){this._byId[t.cid]=t,null!=t.id&&(this._byId[t.id]=t),t.collection||(t.collection=this),t.on("all",this._onModelEvent,this)},_removeReference:function(t){this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,n,i){("add"!==t&&"remove"!==t||n===this)&&("destroy"===t&&this.remove(e,i),e&&t==="change:"+e.idAttribute&&(delete this._byId[e.previous(e.idAttribute)],null!=e.id&&(this._byId[e.id]=e)),this.trigger.apply(this,arguments))}});var v=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample"];n.each(v,function(t){f.prototype[t]=function(){var e=o.call(arguments);return e.unshift(this.models),n[t].apply(n,e)}});var y=["groupBy","countBy","sortBy","indexBy"];n.each(y,function(t){f.prototype[t]=function(e,i){var r=n.isFunction(e)?e:function(t){return t.get(e)};return n[t](this.models,r,i)}});var b=e.View=function(t){this.cid=n.uniqueId("view"),t||(t={}),n.extend(this,n.pick(t,x)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},w=/^(\S+)\s*(.*)$/,x=["model","collection","el","id","attributes","className","tagName","events"];n.extend(b.prototype,a,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(t,n){return this.$el&&this.undelegateEvents(),this.$el=t instanceof e.$?t:e.$(t),this.el=this.$el[0],n!==!1&&this.delegateEvents(),this},delegateEvents:function(t){if(!t&&!(t=n.result(this,"events")))return this;this.undelegateEvents();for(var e in t){var i=t[e];if(n.isFunction(i)||(i=this[t[e]]),i){var r=e.match(w),s=r[1],o=r[2];i=n.bind(i,this),s+=".delegateEvents"+this.cid,""===o?this.$el.on(s,i):this.$el.on(s,o,i)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(n.result(this,"el"),!1);else{var t=n.extend({},n.result(this,"attributes"));this.id&&(t.id=n.result(this,"id")),this.className&&(t["class"]=n.result(this,"className"));var i=e.$("<"+n.result(this,"tagName")+">").attr(t);this.setElement(i,!1)}}}),e.sync=function(t,i,r){var s=_[t];n.defaults(r||(r={}),{emulateHTTP:e.emulateHTTP,emulateJSON:e.emulateJSON});var o={type:s,dataType:"json"};if(r.url||(o.url=n.result(i,"url")||$()),null!=r.data||!i||"create"!==t&&"update"!==t&&"patch"!==t||(o.contentType="application/json",o.data=JSON.stringify(r.attrs||i.toJSON(r))),r.emulateJSON&&(o.contentType="application/x-www-form-urlencoded",o.data=o.data?{model:o.data}:{}),r.emulateHTTP&&("PUT"===s||"DELETE"===s||"PATCH"===s)){o.type="POST",r.emulateJSON&&(o.data._method=s);var a=r.beforeSend;r.beforeSend=function(t){return t.setRequestHeader("X-HTTP-Method-Override",s),a?a.apply(this,arguments):void 0}}"GET"===o.type||r.emulateJSON||(o.processData=!1),"PATCH"===o.type&&C&&(o.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var u=r.xhr=e.ajax(n.extend(o,r));return i.trigger("request",i,u,r),u};var C=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),_={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};e.ajax=function(){return e.$.ajax.apply(e.$,arguments)};var F=e.Router=function(t){t||(t={}),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},S=/\((.*?)\)/g,T=/(\(\?)?:\w+/g,z=/\*\w+/g,I=/[\-{}\[\]+?.,\\\^$|#\s]/g;n.extend(F.prototype,a,{initialize:function(){},route:function(t,i,r){n.isRegExp(t)||(t=this._routeToRegExp(t)),n.isFunction(i)&&(r=i,i=""),r||(r=this[i]);var s=this;return e.history.route(t,function(n){var o=s._extractParameters(t,n);s.execute(r,o),s.trigger.apply(s,["route:"+i].concat(o)),s.trigger("route",i,o),e.history.trigger("route",s,i,o)}),this},execute:function(t,e){t&&t.apply(this,e)},navigate:function(t,n){return e.history.navigate(t,n),this},_bindRoutes:function(){if(this.routes){this.routes=n.result(this,"routes");for(var t,e=n.keys(this.routes);null!=(t=e.pop());)this.route(t,this.routes[t])}},_routeToRegExp:function(t){return t=t.replace(I,"\\$&").replace(S,"(?:$1)?").replace(T,function(t,e){return e?t:"([^/?]+)"}).replace(z,"([^?]*?)"),new RegExp("^"+t+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(t,e){var i=t.exec(e).slice(1);return n.map(i,function(t,e){return e===i.length-1?t||null:t?decodeURIComponent(t):null})}});var P=e.History=function(){this.handlers=[],n.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},k=/^[#\/]|\s+$/g,M=/^\/+|\/+$/g,A=/msie [\w.]+/,E=/\/$/,R=/#.*$/;P.started=!1,n.extend(P.prototype,a,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root},getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getFragment:function(t,e){if(null==t)if(this._hasPushState||!this._wantsHashChange||e){t=decodeURI(this.location.pathname+this.location.search);var n=this.root.replace(E,"");t.indexOf(n)||(t=t.slice(n.length))}else t=this.getHash();return t.replace(k,"")},start:function(t){if(P.started)throw new Error("Backbone.history has already been started");P.started=!0,this.options=n.extend({root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var i=this.getFragment(),r=document.documentMode,s=A.exec(navigator.userAgent.toLowerCase())&&(!r||7>=r);if(this.root=("/"+this.root+"/").replace(M,"/"),s&&this._wantsHashChange){var o=e.$('<iframe src="javascript:0" tabindex="-1">');this.iframe=o.hide().appendTo("body")[0].contentWindow,this.navigate(i)}this._hasPushState?e.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!s?e.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=i;var a=this.location;
if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+"#"+this.fragment),!0;this._hasPushState&&this.atRoot()&&a.hash&&(this.fragment=this.getHash().replace(k,""),this.history.replaceState({},document.title,this.root+this.fragment))}return this.options.silent?void 0:this.loadUrl()},stop:function(){e.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),P.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(){var t=this.getFragment();return t===this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe))),t===this.fragment?!1:(this.iframe&&this.navigate(t),this.loadUrl(),void 0)},loadUrl:function(t){return t=this.fragment=this.getFragment(t),n.any(this.handlers,function(e){return e.route.test(t)?(e.callback(t),!0):void 0})},navigate:function(t,e){if(!P.started)return!1;e&&e!==!0||(e={trigger:!!e});var n=this.root+(t=this.getFragment(t||""));if(t=t.replace(R,""),this.fragment!==t){if(this.fragment=t,""===t&&"/"!==n&&(n=n.slice(0,-1)),this._hasPushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getFragment(this.getHash(this.iframe))&&(e.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,t,e.replace))}return e.trigger?this.loadUrl(t):void 0}},_updateHash:function(t,e,n){if(n){var i=t.href.replace(/(javascript:|#).*$/,"");t.replace(i+"#"+e)}else t.hash="#"+e}}),e.history=new P;var D=function(t,e){var i,r=this;i=t&&n.has(t,"constructor")?t.constructor:function(){return r.apply(this,arguments)},n.extend(i,r,e);var s=function(){this.constructor=i};return s.prototype=r.prototype,i.prototype=new s,t&&n.extend(i.prototype,t),i.__super__=r.prototype,i};h.extend=f.extend=F.extend=b.extend=P.extend=D;var $=function(){throw new Error('A "url" property or function must be specified')},q=function(t,e){var n=e.error;e.error=function(i){n&&n(t,i,e),t.trigger("error",t,i,e)}};return e}),define("modules/backbone-mozu-validation",["underscore","backbone","hyprlive"],function(t,e,n){return e.Validation=function(t){var i={forceUpdate:!1,selector:"name",labelFormatter:"sentenceCase",valid:Function.prototype,invalid:Function.prototype},r={formatLabel:function(t,e){return d[i.labelFormatter](t,e)},format:function(){var t=Array.prototype.slice.call(arguments),e=t.shift();return e.replace(/\{(\d+)\}/g,function(e,n){return"undefined"!=typeof t[n]?t[n]:e})}},s=20,o=function(n,i,r,a){if(0===a)throw"Cannot flatten circular object.";return a||(a=s),i=i||{},r=r||"",n instanceof e.Model&&(n=n.attributes),t.each(n,function(t,s){n.hasOwnProperty(s)&&(t&&"object"==typeof t&&!(t instanceof Array||t instanceof Date||t instanceof RegExp||t instanceof e.Collection)?o(t,i,r+s+".",--a):i[r+s]=t)}),i},a=function(){var e=function(e){return t.reduce(t.keys(e.validation||{}),function(t,e){return t[e]=void 0,t},{})},n=function(e,n){var i=e.validation?e.validation[n]||{}:{};return(t.isFunction(i)||t.isString(i))&&(i={fn:i}),t.isArray(i)||(i=[i]),t.reduce(i,function(e,n){return t.each(t.without(t.keys(n),"msg"),function(t){e.push({fn:h[t],val:n[t],msg:n.msg})}),e},[])},s=function(e,i,s,o){return t.reduce(n(e,i),function(n,a){var u=t.extend({},r,h),l=a.fn.call(u,s,i,a.val,e,o);return l===!1||n===!1?!1:l&&!n?a.msg||l:n},"")},a=function(e,n){var i,r={},a=!0,u=t.clone(n),l=o(n);return t.each(l,function(t,n){i=s(e,n,t,u),i&&(r[n]=i,a=!1)}),{invalidAttrs:r,isValid:a}},l=function(n,i){return{preValidate:function(e,n){return s(this,e,n,t.extend({},this.attributes))},isValid:function(e){var n=o(this.attributes);return t.isString(e)?!s(this,e,n[e],t.extend({},this.attributes)):t.isArray(e)?t.reduce(e,function(e,i){return e&&!s(this,i,n[i],t.extend({},this.attributes))},!0,this):(e===!0&&this.validate(null,{silent:!0}),this.validation?this._isValid:!0)},validate:function(r,s){var u=this,l=!r,c=t.extend({},i,s),d=e(u),h=r;"string"==typeof r&&(h={},t.each(d,function(t,e){0===e.indexOf(r)&&(h[e]=t)}));var p=t.extend({},d,h,u.attributes),f=o(h||p),g=a(u,p);return u._isValid=g.isValid,t.each(d,function(t,e){var r=g.invalidAttrs.hasOwnProperty(e);r||i.silent||c.valid(n,e,c.selector)}),t.each(d,function(t,e){var r=g.invalidAttrs.hasOwnProperty(e),s=f.hasOwnProperty(e);r&&(s||l)&&!i.silent&&c.invalid(n,e,g.invalidAttrs[e],c.selector)}),t.defer(function(){u.trigger("validated",u._isValid,u,g.invalidAttrs),u.trigger("validated:"+(u._isValid?"valid":"invalid"),u,g.invalidAttrs)}),!c.forceUpdate&&t.intersection(t.keys(g.invalidAttrs),t.keys(f)).length>0?g.invalidAttrs:void 0}}},c=function(e,n,i){t.extend(n,l(e,i))},d=function(t){delete t.validate,delete t.preValidate,delete t.isValid},p=function(t){c(this.view,t,this.options)},f=function(t){d(t)};return{version:"0.8.1",configure:function(e){t.extend(i,e)},bind:function(e,n){var r=e.model,s=e.collection;if(n=t.extend({},i,u,n),"undefined"==typeof r&&"undefined"==typeof s)throw"Before you execute the binding your view must have a model or a collection.\nSee http://thedersen.com/projects/backbone-validation/#using-form-model-validation for more information.";r?c(e,r,n):s&&(s.each(function(t){c(e,t,n)}),s.bind("add",p,{view:e,options:n}),s.bind("remove",f))},unbind:function(t){var e=t.model,n=t.collection;e&&d(t.model),n&&(n.each(function(t){d(t)}),n.unbind("add",p),n.unbind("remove",f))},mixin:l(null,i)}}(),u=a.callbacks={valid:function(t,e){t.$('[data-mz-value="'+e+'"]').removeClass("is-invalid"),t.$('[data-mz-validationmessage-for="'+e+'"]').text("")},invalid:function(t,e,n){t.$('[data-mz-value="'+e+'"]').addClass("is-invalid"),t.$('[data-mz-validationmessage-for="'+e+'"]').text(n)}},l=a.patterns={digits:/^\d+$/,number:/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/,email:/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i,url:/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i},c=a.messages={required:n.getLabel("genericRequired"),acceptance:n.getLabel("genericAcceptance"),min:n.getLabel("genericMin"),max:n.getLabel("genericMax"),range:n.getLabel("genericRange"),length:n.getLabel("genericLength"),minLength:n.getLabel("genericMinLength"),maxLength:n.getLabel("genericMaxLength"),rangeLength:n.getLabel("genericRangeLength"),oneOf:n.getLabel("genericOneOf"),equalTo:n.getLabel("genericEqualTo"),pattern:n.getLabel("genericPattern")},d=a.labelFormatters={none:function(t){return t},sentenceCase:function(t){return t.replace(/(?:^\w|[A-Z]|\b\w)/g,function(t,e){return 0===e?t.toUpperCase():" "+t.toLowerCase()}).replace(/_/g," ")},label:function(t,e){return e.labels&&e.labels[t]||d.sentenceCase(t,e)}},h=a.validators=function(){var e=String.prototype.trim?function(t){return null===t?"":String.prototype.trim.call(t)}:function(t){var e=/^\s+/,n=/\s+$/;return null===t?"":t.toString().replace(e,"").replace(n,"")},n=function(e){return t.isNumber(e)||t.isString(e)&&e.match(l.number)},i=function(n){return!(t.isNull(n)||t.isUndefined(n)||t.isString(n)&&""===e(n)||t.isArray(n)&&t.isEmpty(n))};return{fn:function(e,n,i,r,s){if(t.isString(i)){var o=n.split(".");o.length>1&&(o.pop(),r=r.get(o.join("."))),i=r[i]}return i.call(r,e,n,s)},required:function(e,n,r,s,o){var a=t.isFunction(r)?r.call(s,e,n,o):r;return a||i(e)?a&&!i(e)?this.format(c.required,this.formatLabel(n,s)):void 0:!1},acceptance:function(e,n,i,r){return"true"===e||t.isBoolean(e)&&e!==!1?void 0:this.format(c.acceptance,this.formatLabel(n,r))},min:function(t,e,i,r){return!n(t)||i>t?this.format(c.min,this.formatLabel(e,r),i):void 0},max:function(t,e,i,r){return!n(t)||t>i?this.format(c.max,this.formatLabel(e,r),i):void 0},range:function(t,e,i,r){return!n(t)||t<i[0]||t>i[1]?this.format(c.range,this.formatLabel(e,r),i[0],i[1]):void 0},length:function(t,n,r,s){return i(t)&&e(t).length===r?void 0:this.format(c.length,this.formatLabel(n,s),r)},minLength:function(t,n,r,s){return!i(t)||e(t).length<r?this.format(c.minLength,this.formatLabel(n,s),r):void 0},maxLength:function(t,n,r,s){return!i(t)||e(t).length>r?this.format(c.maxLength,this.formatLabel(n,s),r):void 0},rangeLength:function(t,n,r,s){return!i(t)||e(t).length<r[0]||e(t).length>r[1]?this.format(c.rangeLength,this.formatLabel(n,s),r[0],r[1]):void 0},oneOf:function(e,n,i,r){return t.include(i,e)?void 0:this.format(c.oneOf,this.formatLabel(n,r),i.join(", "))},equalTo:function(t,e,n,i,r){return t!==r[n]?this.format(c.equalTo,this.formatLabel(e,i),this.formatLabel(n,i)):void 0},pattern:function(t,e,n,r){return i(t)&&t.toString().match(l[n]||n)?void 0:this.format(c.pattern,this.formatLabel(e,r),n)}}}();return a}(t),e}),function(t,e,n){"undefined"!=typeof module&&module.exports?module.exports=n():"function"==typeof define&&define.amd?define("vendor/jquery-scrollto",n):e[t]=n()}("jquery-scrollto",this,function(t){var e,n,i;return e=n=window.jQuery||t("jquery"),n.propHooks.scrollTop=n.propHooks.scrollLeft={get:function(t,e){var n=null;return("HTML"===t.tagName||"BODY"===t.tagName)&&("scrollLeft"===e?n=window.scrollX:"scrollTop"===e&&(n=window.scrollY)),null==n&&(n=t[e]),n}},n.Tween.propHooks.scrollTop=n.Tween.propHooks.scrollLeft={get:function(t){return n.propHooks.scrollTop.get(t.elem,t.prop)},set:function(t){"HTML"===t.elem.tagName||"BODY"===t.elem.tagName?(t.options.bodyScrollLeft=t.options.bodyScrollLeft||window.scrollX,t.options.bodyScrollTop=t.options.bodyScrollTop||window.scrollY,"scrollLeft"===t.prop?t.options.bodyScrollLeft=Math.round(t.now):"scrollTop"===t.prop&&(t.options.bodyScrollTop=Math.round(t.now)),window.scrollTo(t.options.bodyScrollLeft,t.options.bodyScrollTop)):t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},i={config:{axis:"xy",duration:400,easing:"swing",callback:void 0,durationMode:"each",offsetTop:0,offsetLeft:0},configure:function(t){return n.extend(i.config,t||{}),this},scroll:function(t,e){var r,s,o,a,u,l,c,d,h,p,f,g,m,v,y,b,w,x;return r=t.pop(),s=r.$container,o=r.$target,l=s.prop("tagName"),a=n("<span/>").css({position:"absolute",top:"0px",left:"0px"}),u=s.css("position"),s.css({position:"relative"}),a.appendTo(s),f=a.offset().top,g=o.offset().top,m=g-f-parseInt(e.offsetTop,10),v=a.offset().left,y=o.offset().left,b=y-v-parseInt(e.offsetLeft,10),c=s.prop("scrollTop"),d=s.prop("scrollLeft"),a.remove(),s.css({position:u}),w={},x=function(){return 0===t.length?"function"==typeof e.callback&&e.callback():i.scroll(t,e),!0},e.onlyIfOutside&&(h=c+s.height(),p=d+s.width(),m>c&&h>m&&(m=c),b>d&&p>b&&(b=d)),m!==c&&(w.scrollTop=m),b!==d&&(w.scrollLeft=b),(s.prop("scrollHeight")===s.width()||-1===e.axis.indexOf("y"))&&delete w.scrollTop,(s.prop("scrollWidth")===s.width()||-1===e.axis.indexOf("x"))&&delete w.scrollLeft,null!=w.scrollTop||null!=w.scrollLeft?s.animate(w,{duration:e.duration,easing:e.easing,complete:x}):x(),!0},fn:function(t){var e,r,s,o;e=[];var a=n(this);if(0===a.length)return this;for(r=n.extend({},i.config,t),s=a.parent(),o=s.get(0);1===s.length&&o!==document.body&&o!==document;){var u,l;u="visible"!==s.css("overflow-y")&&o.scrollHeight!==o.clientHeight,l="visible"!==s.css("overflow-x")&&o.scrollWidth!==o.clientWidth,(u||l)&&(e.push({$container:s,$target:a}),a=s),s=s.parent(),o=s.get(0)}return e.push({$container:n("html"),$target:a}),"all"===r.durationMode&&(r.duration/=e.length),i.scroll(e,r),this}},n.ScrollTo=n.ScrollTo||i,n.fn.ScrollTo=n.fn.ScrollTo||i.fn,i}),function(t){"function"==typeof define&&define.amd?define("vendor/jquery.cookie/jquery.cookie",["jquery"],t):"object"==typeof exports?t(require("jquery")):t(jQuery)}(function(t){function e(t){return a.raw?t:encodeURIComponent(t)}function n(t){return a.raw?t:decodeURIComponent(t)}function i(t){return e(a.json?JSON.stringify(t):String(t))}function r(t){0===t.indexOf('"')&&(t=t.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return t=decodeURIComponent(t.replace(o," ")),a.json?JSON.parse(t):t}catch(e){}}function s(e,n){var i=a.raw?e:r(e);return t.isFunction(n)?n(i):i}var o=/\+/g,a=t.cookie=function(r,o,u){if(void 0!==o&&!t.isFunction(o)){if(u=t.extend({},a.defaults,u),"number"==typeof u.expires){var l=u.expires,c=u.expires=new Date;c.setTime(+c+864e5*l)}return document.cookie=[e(r),"=",i(o),u.expires?"; expires="+u.expires.toUTCString():"",u.path?"; path="+u.path:"",u.domain?"; domain="+u.domain:"",u.secure?"; secure":""].join("")}for(var d=r?void 0:{},h=document.cookie?document.cookie.split("; "):[],p=0,f=h.length;f>p;p++){var g=h[p].split("="),m=n(g.shift()),v=g.join("=");if(r&&r===m){d=s(v,o);break}r||void 0===(v=s(v))||(d[m]=v)}return d};a.defaults={},t.removeCookie=function(e,n){return void 0===t.cookie(e)?!1:(t.cookie(e,"",t.extend({},n,{expires:-1})),!t.cookie(e))}}),define("modules/jquery-mozu",["jquery","vendor/jquery-scrollto","vendor/jquery.cookie/jquery.cookie"],function(t){return t.fn.jsonData=function(e){var n=this.attr("data-mz-"+e);return"string"==typeof n&&n.charAt(0).match(/[\{\[\(]/)?t.parseJSON(n):n},t.fn.noFlickerFadeIn=function(){this.css("visibility","visible"),Modernizr.csstransitions?this.css("opacity",1):this.animate({opacity:1},300)},t.deparam=function(t){t=t||window.location.search,t=t.substring(t.indexOf("?")+1).split("&");var e,n,i={},r=decodeURIComponent;for(n=t.length;n>0;)e=t[--n].split("="),i[r(e[0])]=r(e[1]);return i},t.noConflict()}),define("modules/models-messages",["backbone","hyprlive"],function(t,e){var n=require.mozuData("pagecontext").isDebugMode,i=e.getLabel("unexpectedError"),r=t.Model.extend({toJSON:function(){var e=t.Model.prototype.toJSON.apply(this);return(!n&&"UNEXPECTED_ERROR"===e.errorCode||!e.message)&&(e.message=i),e}}),s=t.Collection.extend({model:r});return{Message:r,MessagesCollection:s}}),define("modules/backbone-mozu-model",["modules/jquery-mozu","underscore","modules/api","backbone","modules/models-messages","modules/backbone-mozu-validation"],function(t,e,n,i,r){function s(t){var n={};return e.each(t,function(t,e){var i,r=n;for(e=e.split(".");e.length>1;)i=e.shift(),r=r[i]||(r[i]={});r[e[0]]=t}),n}function o(t,n,i){return e.each(t.validation,function(t,e){n[i+e]=t}),t.__validationFlattened||e.each(t.relations,function(t,e){o(t.prototype,n,e+".")}),t.__validationFlattened=!0,n}var a=t(window),u=i.Model,l=i.Collection,c={read:"get","delete":"del"},d=e.extend({},i.Validation.mixin,{passErrors:function(){var t=this;e.defer(function(){var e=t,n=function(t,n){e.trigger("error",t,n)};do{if(e.handlesMessages){t.on("error",n);break}e=e.parent}while(e)},300)},get:function(t){for(var e,n=t.split("."),r=this;r&&(e=n.shift());)r=i.Model.prototype.get.call(r,e);return!r&&this.relations&&t in this.relations&&(r=this.setRelation(t,null,{silent:!0}),this.attributes[t]=r),r},setRelation:function(t,n,i){var r=this.attributes[t],s=this.idAttribute||"id";if("parse"in i||(i.parse=!0),this.relations&&e.has(this.relations,t)){if(r&&r instanceof l)return s=r.model.prototype.idAttribute||s,n instanceof l||n instanceof Array?(n=n.models||n,r.reset(e.clone(n),i)):r.each(function(t){n&&n[s]===t[s]?t.set(n,i):r.remove(t)}),r;if(r&&r instanceof u)return i.unset?r.clear(i):r.set(n&&n.toJSON?n.toJSON():n,i),r;i._parent=this,n instanceof this.relations[t]||(n=new this.relations[t](n,i)),n.parent=this}return n},set:function(t,n,i){var r,o,a,u,l,c,d,h;if(!t&&0!==t)return this;if("object"==typeof t?(o=t,i=n):(o={})[t]=n,i=i||{},o=s(o),!this._validate(o,i))return!1;a=i.unset,l=i.silent,u=[],c=this._changing,this._changing=!0,c||(this._previousAttributes=e.clone(this.attributes),this.changed={}),h=this.attributes,d=this._previousAttributes,this.idAttribute in o&&(this.id=o[this.idAttribute]);for(r in o){n=o[r],n=this.setRelation(r,n,i),this.dataTypes&&r in this.dataTypes&&(n=this.dataTypes[r](n)),e.isEqual(h[r],n)||u.push(r),e.isEqual(d[r],n)?delete this.changed[r]:this.changed[r]=n;var p=this.relations&&this.relations[r]&&n instanceof this.relations[r];a&&!p?delete h[r]:h[r]=n}if(!l){u.length&&(this._pending=!0);for(var f=0,g=u.length;g>f;f++)this.trigger("change:"+u[f],this,h[u[f]],i)}if(c)return this;if(!l)for(;this._pending;)this._pending=!1,this.trigger("change",this,i,o);return this._pending=!1,this._changing=!1,this},initApiModel:function(t){var i=this;this.apiModel=n.createSync(this.mozuType,e.extend({},e.result(this,"defaults")||{},t)),this.apiModel&&this.apiModel.on&&(this.apiModel.on("action",function(){i.isLoading(!0),i.trigger("request")}),this.apiModel.on("sync",function(t){i.isLoading(!1),t&&(i._isSyncing=!0,i.set(t),i._isSyncing=!1),i.trigger("sync",t)}),this.apiModel.on("spawn",function(){i.isLoading(!1)}),this.apiModel.on("error",function(t){i.isLoading(!1),i.trigger("error",t)}),this.on("change",function(){if(!i._isSyncing){var t=i.changedAttributes();e.each(t,function(t,e,n){t&&"function"==typeof t.toJSON&&(n[e]=t.toJSON())}),i.apiModel.prop(t)}}))},syncApiModel:function(){this.apiModel.prop(this.toJSON())},initMessages:function(){var t=this;t.messages=new r.MessagesCollection,t.hasMessages=function(){return t.messages.length>0},t.helpers.push("hasMessages"),t.on("error",function(e){e.items&&e.items.length?t.messages.reset(e.items):t.messages.reset([e])}),t.on("sync",function(e){e&&e.messages&&0!==e.messages.length||t.messages.reset()}),e.each(this.relations,function(e,n){var i=t.get(n);i&&t.listenTo(i,"error",function(e){t.trigger("error",e)})})},fetch:function(){var t=this;return this.apiModel.get().then(function(){return t})},sync:function(t,e,n){t=c[t]||t,e.apiModel[t](e.attributes).then(function(t){n.success(t.data)},function(t){n.error(t)})},isLoading:function(t,n){return 0===arguments.length?!!this._isLoading:(this._isLoading=t,t?(this._cleanup=this._cleanup||e.bind(this.isLoading,this,!1),this._isWatchingUnload=!0,a.on("beforeunload",this._cleanup)):this._isWatchingUnload&&(delete this._isWatchingUnload,a.off("beforeunload",this._cleanup)),n&&n.silent||this.trigger("loadingchange",t),void 0)},getHelpers:function(){return this.helpers},whenReady:function(t){var e=this,n=this.isLoading();if(!n)return t();var i=function(n){n||(e.off("loadingchange",i),t())};e.on("loadingchange",i)},toJSON:function(t){var n=e.clone(this.attributes);return t&&t.helpers&&(e.each(this.getHelpers(),function(t){n[t]=this[t]()},this),this.hasMessages&&(n.messages=this.messages.toJSON()),this.validation&&(n.isValid=this.isValid(t.forceValidation))),e.each(this.relations,function(i,r){e.has(n,r)&&(n[r]=n[r].toJSON(t))}),t&&t.ensureCopy?JSON.parse(JSON.stringify(n)):n}});d.constructor=function(t){this.helpers=(this.helpers||[]).concat(["isLoading","isValid"]),i.Model.apply(this,arguments),this.mozuType&&this.initApiModel(t),this.handlesMessages?this.initMessages():this.passErrors()};i.MozuModel=i.Model.extend(d,{fromCurrent:function(){return new this(require.mozuData(this.prototype.mozuType),{silent:!0,parse:!0})},DataTypes:{Int:function(t){return t=parseInt(t,10),isNaN(t)?0:t},Float:function(t){return t=parseFloat(t),isNaN(t)?0:t},Boolean:function(t){return"string"==typeof t?"true"===t.toLowerCase():!!t}}});return i.MozuModel.extend=function(r,s){if(r&&(r.validation=o(r,{},"")),r&&r.mozuType){var a=n.getAvailableActionsFor(r.mozuType);a&&e.each(a,function(e){var n="api"+e.charAt(0).toUpperCase()+e.substring(1);n in r||(r[n]=function(n){var i=this;e in{create:!0,update:!0}&&(n=n||this.toJSON()),"object"!=typeof n||t.isArray(n)||t.isPlainObject(n)||(n=null),this.syncApiModel(),this.isLoading(!0);var r=this.apiModel[e](n);return r.ensure(function(){i.isLoading(!1)}),r})})}var u=i.Model.extend.call(this,r,s);return r&&r.helpers&&r.helpers.length>0&&this.prototype.helpers&&this.prototype.helpers.length>0&&(u.prototype.helpers=e.union(this.prototype.helpers,r.helpers)),u},i.Collection.prototype.resetRelations=function(t){e.each(this.models,function(n){e.each(n.relations,function(e,r){n.get(r)instanceof i.Collection&&n.get(r).trigger("reset",n,t)})})},i.Collection.prototype.reset=function(t,n){n=n||{};for(var i=0,r=this.models.length;r>i;i++)this._removeReference(this.models[i]);return n.previousModels=this.models,this._reset(),this.add(t,e.extend({silent:!0},n)),n.silent||(this.trigger("reset",this,n),this.resetRelations(n)),this},i}),define("modules/backbone-mozu-pagedcollection",["jquery","hyprlive","modules/backbone-mozu-model"],function(t,e,n){{var i=e.getThemeSetting("defaultPageSize"),r=e.getThemeSetting("defaultSort"),s=[{text:e.getLabel("default"),value:r},{text:e.getLabel("sortByPriceAsc"),value:"price asc"},{text:e.getLabel("sortByPriceDesc"),value:"price desc"},{text:e.getLabel("sortByNameAsc"),value:"productName asc"},{text:e.getLabel("sortByNameDesc"),value:"productName desc"},{text:e.getLabel("sortByDateDesc"),value:"createDate desc"},{text:e.getLabel("sortByDateAsc"),value:"createDate asc"}];n.MozuPagedCollection=n.MozuModel.extend({helpers:["firstIndex","lastIndex","middlePageNumbers","hasPreviousPage","hasNextPage","currentPage","sorts","currentSort"],validation:{pageSize:{min:1},pageCount:{min:1},totalCount:{min:0},startIndex:{min:0}},dataTypes:{pageSize:n.MozuModel.DataTypes.Int,pageCount:n.MozuModel.DataTypes.Int,startIndex:n.MozuModel.DataTypes.Int,totalCount:n.MozuModel.DataTypes.Int},_isPaged:!0,getQueryString:function(){var e=this,n=_.clone(this.lastRequest);_.each(n,function(t,i){e.baseRequestParams&&i in e.baseRequestParams&&delete n[i]}),parseInt(n.pageSize,10)===i&&delete n.pageSize,this.query&&(n.query=this.query);var r=this.get("startIndex");return r&&(n.startIndex=r),_.isEmpty(n)?"":"?"+t.param(n)},buildRequest:function(){var e=this.baseRequestParams?_.clone(this.baseRequestParams):{},n=this.get("pageSize"),i=this.get("startIndex"),s=t.deparam().sortBy||this.currentSort()||r;return e.pageSize=n,i&&(e.startIndex=i),s&&(e.sortBy=s),e},previousPage:function(){try{return this.apiModel.prevPage(this.lastRequest)}catch(t){}},nextPage:function(){try{return this.apiModel.nextPage(this.lastRequest)}catch(t){}},syncIndex:function(e){try{var n=parseInt(t.deparam(e).startIndex||0,10);if(!isNaN(n)&&n!==this.apiModel.getIndex())return this.lastRequest.startIndex=n,this.apiModel.setIndex(n,this.lastRequest)}catch(i){}},setPage:function(e){return e=parseInt(e,10),e!=this.currentPage()&&e<=parseInt(this.get("pageCount"),10)?this.apiGet(t.extend(this.lastRequest,{startIndex:(e-1)*parseInt(this.get("pageSize"),10)})):void 0},changePageSize:function(){return this.apiGet(t.extend(this.lastRequest,{pageSize:this.get("pageSize")}))},firstIndex:function(){return this.get("startIndex")+1},lastIndex:function(){return this.get("startIndex")+this.get("items").length},hasPreviousPage:function(){return this.get("startIndex")>0},hasNextPage:function(){return this.lastIndex()<this.get("totalCount")},currentPage:function(){return Math.ceil(this.firstIndex()/(this.get("pageSize")||1))},middlePageNumbers:function(){for(var t=this.currentPage(),e=[],n=this.get("pageCount"),i=Math.max(Math.min(t-2,n-4),2),r=Math.min(i+5,n);r>i;)e.push(i++);return e},sorts:function(){return s},currentSort:function(){return this.lastRequest&&this.lastRequest.sortBy&&decodeURIComponent(this.lastRequest.sortBy).replace(/\+/g," ")},sortBy:function(e){return this.apiGet(t.extend(this.lastRequest,{sortBy:e}))},initialize:function(){this.lastRequest=this.buildRequest()}})}return n}),define("modules/views-messages",["modules/jquery-mozu","underscore","backbone","hyprlive"],function(t,e,n,i){var r,s=parseInt(i.getThemeSetting("gutterWidth"),10)||10;return function(t){return r||(r=n.MozuView.extend({templateName:"modules/common/message-bar",initialize:function(){this.model.on("reset",this.render,this)},render:function(){n.MozuView.prototype.render.apply(this,arguments),this.model.length>0&&this.$el.ScrollTo({onlyIfOutside:!0,offsetTop:s,offsetLeft:1.5*s,axis:"y"})}})),new r(t)}}),define("modules/backbone-mozu-view",["modules/jquery-mozu","underscore","hyprlive","backbone","modules/views-messages"],function(t,e,n,i,r){i.MozuView=i.View.extend({constructor:function(t){i.View.apply(this,arguments),this.template=n.getTemplate(t.templateName||this.templateName),this.listenTo(this.model,"sync",this.render),this.listenTo(this.model,"loadingchange",this.handleLoadingChange),this.model.handlesMessages&&t.messagesEl&&(this.messageView=r({el:t.messagesEl,model:this.model.messages})),this.renderOnChange&&e.each(this.renderOnChange,function(t){var n=this.model;if(-1!==t.indexOf(".")){for(var i,r=t.split(".");r.length>1;)i=r.shift(),n=n[i]||n.get(i);t=r[0]}this.listenTo(n,"change",e.debounce(this.dequeueRender,150),this),this.listenTo(n,"change:"+t,this.enqueueRender,this)},this),i.Validation.bind(this),i.MozuView.trigger("create",this)},enqueueRender:function(){this.renderQueued=!0},dequeueRender:function(){this.renderQueued&&(this.render(),this.renderQueued=!1)},events:function(){var t=e.object(e.flatten(e.map(this.$("[data-mz-value]"),function(t){var n=t.getAttribute("data-mz-value");return e.map(["change","blur","keyup"],function(t){return[t+' [data-mz-value="'+n+'"]',"update"+n.charAt(0).toUpperCase()+n.substring(1)]})}).concat(e.map(this.$("[data-mz-action]"),function(t){var n=t.getAttribute("data-mz-action");return e.map(["click"],function(t){return[t+' [data-mz-action="'+n+'"]',n]})})),!0));return this.additionalEvents?e.extend(t,this.additionalEvents):t},handleLoadingChange:function(t){this.$el[t?"addClass":"removeClass"]("is-loading")},getRenderContext:function(t){var e=(t||this.model).toJSON({helpers:!0});return{Model:e,model:e}},render:function(e){var n=this.el&&document.activeElement&&"radio"!==document.activeElement.type&&"checkbox"!==document.activeElement.type&&t.contains(this.el,document.activeElement)&&{id:document.activeElement.id,mzvalue:document.activeElement.getAttribute("data-mz-value"),mzFocusBookmark:document.activeElement.getAttribute("data-mz-focus-bookmark"),value:document.activeElement.value};i.Validation.unbind(this),this.undelegateEvents();var r=this.template.render(this.getRenderContext());this.$el.html(r),this.delegateEvents(),i.Validation.bind(this),n&&(n.id?t(document.getElementById(n.id)).focus():n.mzFocusBookmark?this.$('[data-mz-focus-bookmark="'+n.mzFocusBookmark+'"]').focus():n.mzvalue&&this.$('[data-mz-value="'+n.mzvalue+'"]').focus()),e&&e.silent||(this.trigger("render",r),i.MozuView.trigger("render",this,r))}});e.extend(i.MozuView,i.Events,{extend:function(n,r){return n.autoUpdate&&e.each(n.autoUpdate,function(i){var r="update"+i.charAt(0).toUpperCase()+i.substring(1);n[r]=e.debounce(n[r]||function(e){var n={},r=t(e.currentTarget),s=r.prop("checked"),o="checkbox"===e.currentTarget.type?s:r.val();("radio"!==e.currentTarget.type||s)&&(n[i]=o,this.model.set(n))},50)}),i.View.extend.call(this,n,r)}})}),define("modules/backbone-mozu",["modules/backbone-mozu-validation","modules/backbone-mozu-model","modules/backbone-mozu-pagedcollection","modules/backbone-mozu-view"],function(t){return t}),define("modules/cart-monitor",["modules/jquery-mozu","modules/api"],function(t,e){var n,i,r=require.mozuData("user"),s=r.userId,o=t(document),a={setCount:function(e){this.$el.text(e),n[s]=e,t.cookie("mozucartcount",JSON.stringify(n),{path:"/"})},addToCount:function(t){this.setCount(this.getCount()+t)},getCount:function(){return parseInt(this.$el.text(),10)||0},update:function(){e.get("cartsummary").then(function(t){o.ready(function(){a.setCount(t.count())})})}};try{n=JSON.parse(t.cookie("mozucartcount"))}catch(u){}return n||(n={}),i=n&&n[s],isNaN(i)&&a.update(),o.ready(function(){a.$el=t('[data-mz-role="cartmonitor"]').text(i||0)}),a}),define("modules/contextify",["modules/jquery-mozu"],function(t){t(document).ready(function(){t("[data-mz-contextify]").each(function(){var e=t(this),n=e.data();e.find(n.mzContextify).each(function(){var e=t(this);"class"===n.mzContextifyAttr?e.addClass(n.mzContextifyVal):e.prop(n.mzContextifyAttr,n.mzContextifyVal)})})})}),define("shim!vendor/bootstrap/js/tooltip[modules/jquery-mozu=jQuery]>jQuery",["modules/jquery-mozu"],function(t){return+function(t){function e(e){return this.each(function(){var i=t(this),r=i.data("bs.tooltip"),s="object"==typeof e&&e;(r||"destroy"!=e)&&(r||i.data("bs.tooltip",r=new n(this,s)),"string"==typeof e&&r[e]())})}var n=function(t,e){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",t,e)};n.VERSION="3.2.0",n.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},n.prototype.init=function(e,n,i){this.enabled=!0,this.type=e,this.$element=t(n),this.options=this.getOptions(i),this.$viewport=this.options.viewport&&t(this.options.viewport.selector||this.options.viewport);for(var r=this.options.trigger.split(" "),s=r.length;s--;){var o=r[s];if("click"==o)this.$element.on("click."+this.type,this.options.selector,t.proxy(this.toggle,this));else if("manual"!=o){var a="hover"==o?"mouseenter":"focusin",u="hover"==o?"mouseleave":"focusout";this.$element.on(a+"."+this.type,this.options.selector,t.proxy(this.enter,this)),this.$element.on(u+"."+this.type,this.options.selector,t.proxy(this.leave,this))}}this.options.selector?this._options=t.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},n.prototype.getDefaults=function(){return n.DEFAULTS},n.prototype.getOptions=function(e){return e=t.extend({},this.getDefaults(),this.$element.data(),e),e.delay&&"number"==typeof e.delay&&(e.delay={show:e.delay,hide:e.delay}),e},n.prototype.getDelegateOptions=function(){var e={},n=this.getDefaults();return this._options&&t.each(this._options,function(t,i){n[t]!=i&&(e[t]=i)}),e},n.prototype.enter=function(e){var n=e instanceof this.constructor?e:t(e.currentTarget).data("bs."+this.type);return n||(n=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,n)),clearTimeout(n.timeout),n.hoverState="in",n.options.delay&&n.options.delay.show?(n.timeout=setTimeout(function(){"in"==n.hoverState&&n.show()
},n.options.delay.show),void 0):n.show()},n.prototype.leave=function(e){var n=e instanceof this.constructor?e:t(e.currentTarget).data("bs."+this.type);return n||(n=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,n)),clearTimeout(n.timeout),n.hoverState="out",n.options.delay&&n.options.delay.hide?(n.timeout=setTimeout(function(){"out"==n.hoverState&&n.hide()},n.options.delay.hide),void 0):n.hide()},n.prototype.show=function(){var e=t.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(e);var n=t.contains(document.documentElement,this.$element[0]);if(e.isDefaultPrevented()||!n)return;var i=this,r=this.tip(),s=this.getUID(this.type);this.setContent(),r.attr("id",s),this.$element.attr("aria-describedby",s),this.options.animation&&r.addClass("fade");var o="function"==typeof this.options.placement?this.options.placement.call(this,r[0],this.$element[0]):this.options.placement,a=/\s?auto?\s?/i,u=a.test(o);u&&(o=o.replace(a,"")||"top"),r.detach().css({top:0,left:0,display:"block"}).addClass(o).data("bs."+this.type,this),this.options.container?r.appendTo(this.options.container):r.insertAfter(this.$element);var l=this.getPosition(),c=r[0].offsetWidth,d=r[0].offsetHeight;if(u){var h=o,p=this.$element.parent(),f=this.getPosition(p);o="bottom"==o&&l.top+l.height+d-f.scroll>f.height?"top":"top"==o&&l.top-f.scroll-d<0?"bottom":"right"==o&&l.right+c>f.width?"left":"left"==o&&l.left-c<f.left?"right":o,r.removeClass(h).addClass(o)}var g=this.getCalculatedOffset(o,l,c,d);this.applyPlacement(g,o);var m=function(){i.$element.trigger("shown.bs."+i.type),i.hoverState=null};t.support.transition&&this.$tip.hasClass("fade")?r.one("bsTransitionEnd",m).emulateTransitionEnd(150):m()}},n.prototype.applyPlacement=function(e,n){var i=this.tip(),r=i[0].offsetWidth,s=i[0].offsetHeight,o=parseInt(i.css("margin-top"),10),a=parseInt(i.css("margin-left"),10);isNaN(o)&&(o=0),isNaN(a)&&(a=0),e.top=e.top+o,e.left=e.left+a,t.offset.setOffset(i[0],t.extend({using:function(t){i.css({top:Math.round(t.top),left:Math.round(t.left)})}},e),0),i.addClass("in");var u=i[0].offsetWidth,l=i[0].offsetHeight;"top"==n&&l!=s&&(e.top=e.top+s-l);var c=this.getViewportAdjustedDelta(n,e,u,l);c.left?e.left+=c.left:e.top+=c.top;var d=c.left?2*c.left-r+u:2*c.top-s+l,h=c.left?"left":"top",p=c.left?"offsetWidth":"offsetHeight";i.offset(e),this.replaceArrow(d,i[0][p],h)},n.prototype.replaceArrow=function(t,e,n){this.arrow().css(n,t?50*(1-t/e)+"%":"")},n.prototype.setContent=function(){var t=this.tip(),e=this.getTitle();t.find(".tooltip-inner")[this.options.html?"html":"text"](e),t.removeClass("fade in top bottom left right")},n.prototype.hide=function(){function e(){"in"!=n.hoverState&&i.detach(),n.$element.trigger("hidden.bs."+n.type)}var n=this,i=this.tip(),r=t.Event("hide.bs."+this.type);return this.$element.removeAttr("aria-describedby"),this.$element.trigger(r),r.isDefaultPrevented()?void 0:(i.removeClass("in"),t.support.transition&&this.$tip.hasClass("fade")?i.one("bsTransitionEnd",e).emulateTransitionEnd(150):e(),this.hoverState=null,this)},n.prototype.fixTitle=function(){var t=this.$element;(t.attr("title")||"string"!=typeof t.attr("data-original-title"))&&t.attr("data-original-title",t.attr("title")||"").attr("title","")},n.prototype.hasContent=function(){return this.getTitle()},n.prototype.getPosition=function(e){e=e||this.$element;var n=e[0],i="BODY"==n.tagName;return t.extend({},"function"==typeof n.getBoundingClientRect?n.getBoundingClientRect():null,{scroll:i?document.documentElement.scrollTop||document.body.scrollTop:e.scrollTop(),width:i?t(window).width():e.outerWidth(),height:i?t(window).height():e.outerHeight()},i?{top:0,left:0}:e.offset())},n.prototype.getCalculatedOffset=function(t,e,n,i){return"bottom"==t?{top:e.top+e.height,left:e.left+e.width/2-n/2}:"top"==t?{top:e.top-i,left:e.left+e.width/2-n/2}:"left"==t?{top:e.top+e.height/2-i/2,left:e.left-n}:{top:e.top+e.height/2-i/2,left:e.left+e.width}},n.prototype.getViewportAdjustedDelta=function(t,e,n,i){var r={top:0,left:0};if(!this.$viewport)return r;var s=this.options.viewport&&this.options.viewport.padding||0,o=this.getPosition(this.$viewport);if(/right|left/.test(t)){var a=e.top-s-o.scroll,u=e.top+s-o.scroll+i;a<o.top?r.top=o.top-a:u>o.top+o.height&&(r.top=o.top+o.height-u)}else{var l=e.left-s,c=e.left+s+n;l<o.left?r.left=o.left-l:c>o.width&&(r.left=o.left+o.width-c)}return r},n.prototype.getTitle=function(){var t,e=this.$element,n=this.options;return t=e.attr("data-original-title")||("function"==typeof n.title?n.title.call(e[0]):n.title)},n.prototype.getUID=function(t){do t+=~~(1e6*Math.random());while(document.getElementById(t));return t},n.prototype.tip=function(){return this.$tip=this.$tip||t(this.options.template)},n.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},n.prototype.validate=function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},n.prototype.enable=function(){this.enabled=!0},n.prototype.disable=function(){this.enabled=!1},n.prototype.toggleEnabled=function(){this.enabled=!this.enabled},n.prototype.toggle=function(e){var n=this;e&&(n=t(e.currentTarget).data("bs."+this.type),n||(n=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,n))),n.tip().hasClass("in")?n.leave(n):n.enter(n)},n.prototype.destroy=function(){clearTimeout(this.timeout),this.hide().$element.off("."+this.type).removeData("bs."+this.type)};var i=t.fn.tooltip;t.fn.tooltip=e,t.fn.tooltip.Constructor=n,t.fn.tooltip.noConflict=function(){return t.fn.tooltip=i,this}}(t),t}),define("shim!vendor/bootstrap/js/popover[shim!vendor/bootstrap/js/tooltip[modules/jquery-mozu=jQuery]>jQuery=jQuery]>jQuery",["shim!vendor/bootstrap/js/tooltip[modules/jquery-mozu=jQuery]>jQuery"],function(t){return+function(t){function e(e){return this.each(function(){var i=t(this),r=i.data("bs.popover"),s="object"==typeof e&&e;(r||"destroy"!=e)&&(r||i.data("bs.popover",r=new n(this,s)),"string"==typeof e&&r[e]())})}var n=function(t,e){this.init("popover",t,e)};if(!t.fn.tooltip)throw new Error("Popover requires tooltip.js");n.VERSION="3.2.0",n.DEFAULTS=t.extend({},t.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),n.prototype=t.extend({},t.fn.tooltip.Constructor.prototype),n.prototype.constructor=n,n.prototype.getDefaults=function(){return n.DEFAULTS},n.prototype.setContent=function(){var t=this.tip(),e=this.getTitle(),n=this.getContent();t.find(".popover-title")[this.options.html?"html":"text"](e),t.find(".popover-content").empty()[this.options.html?"string"==typeof n?"html":"append":"text"](n),t.removeClass("fade top bottom left right in"),t.find(".popover-title").html()||t.find(".popover-title").hide()},n.prototype.hasContent=function(){return this.getTitle()||this.getContent()},n.prototype.getContent=function(){var t=this.$element,e=this.options;return t.attr("data-content")||("function"==typeof e.content?e.content.call(t[0]):e.content)},n.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")},n.prototype.tip=function(){return this.$tip||(this.$tip=t(this.options.template)),this.$tip};var i=t.fn.popover;t.fn.popover=e,t.fn.popover.Constructor=n,t.fn.popover.noConflict=function(){return t.fn.popover=i,this}}(t),t}),function(t){"function"==typeof define&&define.amd?define("vendor/jquery-placeholder/jquery.placeholder",["jquery"],t):t(jQuery)}(function(t){function e(e){var n={},i=/^jQuery\d+$/;return t.each(e.attributes,function(t,e){e.specified&&!i.test(e.name)&&(n[e.name]=e.value)}),n}function n(e,n){var i=this,s=t(i);if(i.value==s.attr("placeholder")&&s.hasClass(h.customClass))if(s.data("placeholder-password")){if(s=s.hide().nextAll('input[type="password"]:first').show().attr("id",s.removeAttr("id").data("placeholder-id")),e===!0)return s[0].value=n;s.focus()}else i.value="",s.removeClass(h.customClass),i==r()&&i.select()}function i(){var i,r=this,s=t(r),o=this.id;""===r.value?("password"===r.type&&(s.data("placeholder-textinput")||(i=t("<input>").attr(t.extend(e(this),{type:"text"})),i.removeAttr("name").data({"placeholder-password":s,"placeholder-id":o}).bind("focus.placeholder",n),s.data({"placeholder-textinput":i,"placeholder-id":o}).before(i)),s=s.removeAttr("id").hide().prevAll('input[type="text"]:first').attr("id",o).show()),s.addClass(h.customClass),s[0].value=s.attr("placeholder")):s.removeClass(h.customClass)}function r(){try{return document.activeElement}catch(t){}}var s,o,a="[object OperaMini]"==Object.prototype.toString.call(window.operamini),u="placeholder"in document.createElement("input")&&!a,l="placeholder"in document.createElement("textarea")&&!a,c=t.valHooks,d=t.propHooks;if(u&&l)o=t.fn.placeholder=function(){return this},o.input=o.textarea=!0;else{var h={};o=t.fn.placeholder=function(e){var r={customClass:"placeholder"};h=t.extend({},r,e);var s=this;return s.filter((u?"textarea":":input")+"[placeholder]").not("."+h.customClass).bind({"focus.placeholder":n,"blur.placeholder":i}).data("placeholder-enabled",!0).trigger("blur.placeholder"),s},o.input=u,o.textarea=l,s={get:function(e){var n=t(e),i=n.data("placeholder-password");return i?i[0].value:n.data("placeholder-enabled")&&n.hasClass("placeholder")?"":e.value},set:function(e,s){var o=t(e),a=o.data("placeholder-password");return a?a[0].value=s:o.data("placeholder-enabled")?(""===s?(e.value=s,e!=r()&&i.call(e)):o.hasClass(h.customClass)?n.call(e,!0,s)||(e.value=s):e.value=s,o):e.value=s}},u||(c.input=s,d.value=s),l||(c.textarea=s,d.value=s),t(function(){t(document).delegate("form","submit.placeholder",function(){var e=t("."+h.customClass,this).each(n);setTimeout(function(){e.each(i)},10)})}),t(window).bind("beforeunload.placeholder",function(){t("."+h.customClass).each(function(){this.value=""})})}}),define("modules/login-links",["shim!vendor/bootstrap/js/popover[shim!vendor/bootstrap/js/tooltip[modules/jquery-mozu=jQuery]>jQuery=jQuery]>jQuery","modules/api","hyprlive","underscore","vendor/jquery-placeholder/jquery.placeholder"],function(t,e,n,i){var r,s=function(){return!Modernizr.mq("(max-width: 480px)")},o=function(){return!1},a=!("placeholder"in t("<input>")[0]),u=function(){};t.extend(u.prototype,{boundMethods:[],setMethodContext:function(){for(var e=this.boundMethods.length-1;e>=0;e--)this[this.boundMethods[e]]=t.proxy(this[this.boundMethods[e]],this)},dismisser:function(e){t.contains(this.popoverInstance.$tip[0],e.target)||this.loading||(this.$el.popover("destroy"),this.$el.on("click",this.createPopover),this.$el.off("click",o),this.bindListeners(!1),r.off("click",this.dismisser))},setLoading:function(t){this.loading=t,this.$parent[t?"addClass":"removeClass"]("is-loading")},onPopoverShow:function(){var t=this;i.defer(function(){r.on("click",t.dismisser),t.$el.on("click",o)}),this.popoverInstance=this.$el.data("bs.popover"),this.$parent=this.popoverInstance.tip(),this.bindListeners(!0),this.$el.off("click",this.createPopover),a&&this.$parent.find("[placeholder]").placeholder({customClass:"mz-placeholder"})},createPopover:function(t){s()&&(t.preventDefault(),this.$el.popover({animation:!0,html:!0,trigger:"manual",content:this.template,container:"body"}).on("shown.bs.popover",this.onPopoverShow).popover("show"))},displayApiMessage:function(t){this.displayMessage(t.message||t&&t.responseJSON&&t.responseJSON.message||n.getLabel("unexpectedError"))},displayMessage:function(t){this.setLoading(!1),this.$parent.find('[data-mz-role="popover-message"]').html('<span class="mz-validationmessage">'+t+"</span>")},init:function(e){this.$el=t(e),this.loading=!1,this.setMethodContext(),this.pageType?this.$el.on("click",this.doFormSubmit.bind(this)):this.$el.on("click",this.createPopover)},doFormSubmit:function(t){t.preventDefault(),this.$parent=this.$el.closest(this.formSelector),this[this.pageType]()}});var l=function(){u.apply(this,arguments),this.login=i.debounce(this.login,150),this.retrievePassword=i.debounce(this.retrievePassword,150)};l.prototype=new u,t.extend(l.prototype,{boundMethods:["handleEnterKey","handleLoginComplete","displayResetPasswordMessage","dismisser","displayMessage","displayApiMessage","createPopover","slideRight","slideLeft","login","retrievePassword","onPopoverShow"],template:n.getTemplate("modules/common/login-popover").render(),bindListeners:function(t){var e=t?"on":"off";this.$parent[e]("click",'[data-mz-action="forgotpasswordform"]',this.slideRight),this.$parent[e]("click",'[data-mz-action="loginform"]',this.slideLeft),this.$parent[e]("click",'[data-mz-action="submitlogin"]',this.login),this.$parent[e]("click",'[data-mz-action="submitforgotpassword"]',this.retrievePassword),this.$parent[e]("keypress","input",this.handleEnterKey)},onPopoverShow:function(){u.prototype.onPopoverShow.apply(this,arguments),this.panelWidth=this.$parent.find(".mz-l-slidebox-panel").first().outerWidth(),this.$slideboxOuter=this.$parent.find(".mz-l-slidebox-outer"),this.$el.hasClass("mz-forgot")&&this.slideRight()},handleEnterKey:function(e){if(13===e.which){var n=t(e.currentTarget).parents("[data-mz-role]");switch(n.data("mz-role")){case"login-form":this.login();break;case"forgotpassword-form":this.retrievePassword()}return!1}},slideRight:function(t){t&&t.preventDefault(),this.$slideboxOuter.css("left",-this.panelWidth)},slideLeft:function(t){t&&t.preventDefault(),this.$slideboxOuter.css("left",0)},login:function(){this.setLoading(!0),e.action("customer","loginStorefront",{email:this.$parent.find("[data-mz-login-email]").val(),password:this.$parent.find("[data-mz-login-password]").val()}).then(this.handleLoginComplete,this.displayApiMessage)},retrievePassword:function(){this.setLoading(!0),e.action("customer","resetPasswordStorefront",{EmailAddress:this.$parent.find("[data-mz-forgotpassword-email]").val()}).then(this.displayResetPasswordMessage.bind(this),this.displayApiMessage)},handleLoginComplete:function(){window.location.reload()},displayResetPasswordMessage:function(){this.displayMessage(n.getLabel("resetEmailSent"))}});var c=function(){u.apply(this,arguments),this.signup=i.debounce(this.signup,150)};c.prototype=new u,t.extend(c.prototype,l.prototype,{boundMethods:["handleEnterKey","dismisser","displayMessage","displayApiMessage","createPopover","signup","onPopoverShow"],template:n.getTemplate("modules/common/signup-popover").render(),bindListeners:function(t){var e=t?"on":"off";this.$parent[e]("click",'[data-mz-action="signup"]',this.signup),this.$parent[e]("keypress","input",this.handleEnterKey)},handleEnterKey:function(t){13===t.which&&this.signup()},validate:function(t){return t.account.emailAddress?t.password?t.password!==this.$parent.find("[data-mz-signup-confirmpassword]").val()?(this.displayMessage(n.getLabel("passwordsDoNotMatch")),!1):!0:(this.displayMessage(n.getLabel("passwordMissing")),!1):(this.displayMessage(n.getLabel("emailMissing")),!1)},signup:function(){var t=this,n=this.$parent.find("[data-mz-signup-emailaddress]").val(),i=this.$parent.find("[data-mz-signup-firstname]").val(),r=this.$parent.find("[data-mz-signup-lastname]").val(),s={account:{emailAddress:n,userName:n,firstName:i,lastName:r,contacts:[{email:n,firstName:i,lastNameOrSurname:r}]},password:this.$parent.find("[data-mz-signup-password]").val()};return this.validate(s)?(this.setLoading(!0),e.action("customer","createStorefront",s).then(function(){window.location.reload()},t.displayApiMessage)):void 0}}),t(document).ready(function(){r=t(document.body),t('[data-mz-action="login"]').each(function(){var e=new l;e.init(this),t(this).data("mz.popover",e)}),t('[data-mz-action="signup"]').each(function(){var e=new c;e.init(this),t(this).data("mz.popover",e)}),t('[data-mz-action="launchforgotpassword"]').each(function(){var e=new l;e.init(this),t(this).data("mz.popover",e)}),t('[data-mz-action="signuppage-submit"]').each(function(){var t=new c;t.formSelector='form[name="mz-signupform"]',t.pageType="signup",t.init(this)}),t('[data-mz-action="loginpage-submit"]').each(function(){var t=new c;t.formSelector='form[name="mz-loginform"]',t.pageType="login",t.init(this)}),t('[data-mz-action="forgotpasswordpage-submit"]').each(function(){var t=new c;t.formSelector='form[name="mz-forgotpasswordform"]',t.pageType="retrievePassword",t.init(this)})})}),define("modules/models-address",["modules/backbone-mozu","hyprlive"],function(t,e){var n={US:!0,CA:!0,JP:!0,TW:!0},i="n/a",r=t.MozuModel.extend({validation:{home:{required:!0,msg:e.getLabel("phoneMissing")}}}),s=t.MozuModel.extend({mozuType:"address",initialize:function(){this.on("change:countryCode",this.clearStateAndZipWhenCountryChanges,this)},clearStateAndZipWhenCountryChanges:function(){this.unset("postalOrZipCode"),this.unset("stateOrProvince")},validation:{address1:{required:!0,msg:e.getLabel("streetMissing")},cityOrTown:{required:!0,msg:e.getLabel("cityMissing")},countryCode:{required:!0,msg:e.getLabel("countryMissing")},stateOrProvince:{fn:"requiresStateAndZip",msg:e.getLabel("stateProvMissing")},postalOrZipCode:{fn:"requiresStateAndZip",msg:e.getLabel("postalCodeMissing")}},requiresStateAndZip:function(t,e){return this.get("countryCode")in n&&!t?this.validation[e.split(".").pop()].msg:void 0},defaults:{candidateValidatedAddresses:null,countryCode:e.getThemeSetting("preselectCountryCode")||"",addressType:"Residential"},toJSON:function(e){var n=t.MozuModel.prototype.toJSON.apply(this,arguments);return e&&e.helpers||n.stateOrProvince||(n.stateOrProvince=i),e&&e.helpers&&n.stateOrProvince===i&&delete n.stateOrProvince,n},is:function(t){var e="",n="";for(var i in t)if("isValidated"!==i&&(e=(t[i]||"").toLowerCase(),n=(this.get(i)||"").toLowerCase(),e!=n))return!1;return!0}});return{PhoneNumbers:r,StreetAddress:s}}),define("modules/models-price",["underscore","modules/backbone-mozu"],function(t,e){var n=e.MozuModel.extend({dataTypes:{price:e.MozuModel.DataTypes.Float,salePrice:e.MozuModel.DataTypes.Float,offerPrice:e.MozuModel.DataTypes.Float},helpers:["onSale"],onSale:function(){var t=this.get("salePrice");return null!==t&&!isNaN(t)&&t!==this.get("price")}}),i=e.MozuModel.extend({relations:{lower:n,upper:n}});return{ProductPrice:n,ProductPriceRange:i}}),define("modules/models-product",["modules/jquery-mozu","underscore","modules/backbone-mozu","hyprlive","modules/models-price","modules/api"],function(t,e,n,i,r,s){function o(t){for(t=t.toString();t.length<2;)t="0"+t;return t}function a(t){var e=new Date(Date.parse(t)+6e4*(new Date).getTimezoneOffset());return[o(e.getFullYear(),4),o(e.getMonth()+1,2),o(e.getDate(),2)].join("-")}var u=n.MozuModel.extend({idAttribute:"attributeFQN",helpers:["isChecked"],initialize:function(){var n=this;e.defer(function(){n.listenTo(n.collection,"invalidoptionselected",n.handleInvalid,n)});var i=function(t,e){return t.value.toString()===e.toString()},r=function(t,n){return e.some(n,function(e){return i(t,e)})},s=n.get("attributeDetail");s&&(s.valueType===u.Constants.ValueTypes.Predefined&&(this.legalValues=e.chain(this.get("values")).pluck("value").map(function(t){return e.isUndefined(t)||e.isNull(t)?t:t.toString()}).value()),s.inputType===u.Constants.InputTypes.YesNo?n.on("change:value",function(t,i){var r;n.previous("value")!==i&&(r=n.get("values"),e.first(r).isSelected=i,n.set({value:i,shopperEnteredValue:i,values:r},{silent:!0}),n.trigger("optionchange",i,n))}):n.on("change:value",function(s,o){var a,l=n.get("values"),c=this.get("isMultiValue")?r:i;"string"==typeof o&&(o=t.trim(o)),o||o===!1||0===o||""===o?(e.each(l,function(t){c(t,o)?(a=t,t.isSelected=!0,n.set("value",o,{silent:!0})):t.isSelected=!1}),n.set("values",l),n.get("attributeDetail").valueType===u.Constants.ValueTypes.ShopperEntered&&n.set("shopperEnteredValue",o,{silent:!0})):(n.unset("value"),n.unset("shopperEnteredValue")),a&&!a.isEnabled&&n.collection.trigger("invalidoptionselected",a,n),n.trigger("optionchange",o,n)}))},handleInvalid:function(t,n){this!==n&&(this.unset("value"),e.each(this.get("values"),function(t){t.isSelected=!1}))},parse:function(t){var n,i,r;return t.isMultiValue?(i=e.pluck(e.where(t.values,{isSelected:!0}),"value"),i&&i.length>0&&(t.value=i)):(n=e.findWhere(t.values,{isSelected:!0}),n&&(t.value=n.value)),t.attributeDetail&&(t.attributeDetail.valueType!==u.Constants.ValueTypes.Predefined&&(r=t.values[0]&&t.values[0].shopperEnteredValue,(r||0===r)&&(t.shopperEnteredValue=r,t.value=r)),t.attributeDetail.inputType===u.Constants.InputTypes.Date&&t.attributeDetail.validation&&(t.minDate=a(t.attributeDetail.validation.minDateValue),t.maxDate=a(t.attributeDetail.validation.maxDateValue))),t},isChecked:function(){var t=this.get("attributeDetail"),e=this.get("values");return!!(t&&t.inputType===u.Constants.InputTypes.YesNo&&e&&this.get("shopperEnteredValue"))},isValidValue:function(){var t=this.getValueOrShopperEnteredValue();return void 0!==t&&""!==t&&(this.get("attributeDetail").valueType!==u.Constants.ValueTypes.Predefined||(this.get("isMultiValue")?!e.difference(e.map(t,function(t){return t.toString()}),this.legalValues).length:e.contains(this.legalValues,t.toString())))},getValueOrShopperEnteredValue:function(){return this.get("value")||0===this.get("value")?this.get("value"):this.get("shopperEnteredValue")},isConfigured:function(){var t=this.get("attributeDetail");return t?t.inputType===u.Constants.InputTypes.YesNo?this.isChecked():this.isValidValue():!0},toJSON:function(){var t=n.MozuModel.prototype.toJSON.apply(this,arguments);if(t&&t.attributeDetail&&t.attributeDetail.valueType!==u.Constants.ValueTypes.Predefined&&this.isConfigured()){var e=t.value||t.shopperEnteredValue;"Number"===t.attributeDetail.dataType&&(e=parseFloat(e)),t.shopperEnteredValue=t.value=e}return t},addConfiguration:function(t,n){var i,r,s,o,a;this.isConfigured()&&(n&&n.unabridged?t.push(this.toJSON()):(i=this.get("attributeFQN"),r=this.getValueOrShopperEnteredValue(),s=this.get("attributeDetail"),o=s.valueType===u.Constants.ValueTypes.ShopperEntered?"shopperEnteredValue":"value","Number"===s.dataType&&(r=parseFloat(r)),a=function(e){var n={attributeFQN:i};n[o]=e,t.push(n)},e.isArray(r)?e.each(r,a):a(r)))}},{Constants:{ValueTypes:{Predefined:"Predefined",ShopperEntered:"ShopperEntered",AdminEntered:"AdminEntered"},InputTypes:{List:"List",YesNo:"YesNo",Date:"Date"}}}),l=n.MozuModel.extend({}),c=n.MozuModel.extend({mozuType:"product",idAttribute:"productCode",handlesMessages:!0,helpers:["mainImage","notDoneConfiguring","hasPriceRange","supportsInStorePickup"],defaults:{purchasableState:{},quantity:1},dataTypes:{quantity:n.MozuModel.DataTypes.Int},validation:{quantity:{min:1,msg:i.getLabel("enterProductQuantity")}},relations:{content:l,price:r.ProductPrice,priceRange:r.ProductPriceRange,options:n.Collection.extend({model:u})},getBundledProductProperties:function(t){var n=this,i=!t||!t.silent;i&&(this.isLoading(!0),this.trigger("request"));var r=this.get("bundledProducts"),o=r.length,a=s.defer();return e.each(r,function(t){var u=s.get("product",t.productCode);u.ensure(function(){0===--o&&e.defer(function(){n.set("bundledProducts",r),i&&(this.trigger("sync",r),this.isLoading(!1)),a.resolve(r)})}),u.then(function(n){e.each(n.prop("properties"),function(t){t.values&&0!==t.values.length&&""!==t.values[0].value&&""!==t.values[0].stringValue||(t.isEmpty=!0)}),e.extend(t,n.data)})}),a.promise},hasPriceRange:function(){return this._hasPriceRange},calculateHasPriceRange:function(t){this._hasPriceRange=t&&!!t.priceRange},initialize:function(t){var n=this.get("content").get("seoFriendlyUrl");e.bindAll(this,"calculateHasPriceRange","onOptionChange"),this.listenTo(this.get("options"),"optionchange",this.onOptionChange),this.updateConfiguration=e.debounce(this.updateConfiguration,300),this.set({url:n?"/"+n+"/p/"+this.get("productCode"):"/p/"+this.get("productCode")}),this.lastConfiguration=[],this.calculateHasPriceRange(t),this.on("sync",this.calculateHasPriceRange)},mainImage:function(){var t=this.get("content.productImages");return t&&t[0]},notDoneConfiguring:function(){return this.get("productUsage")===c.Constants.ProductUsage.Configurable&&!this.get("variationProductCode")},supportsInStorePickup:function(){return e.contains(this.get("fulfillmentTypesSupported"),c.Constants.FulfillmentTypes.IN_STORE_PICKUP)},getConfiguredOptions:function(t){return this.get("options").reduce(function(e,n){return n.addConfiguration(e,t),e},[])},addToCart:function(){var t=this;this.whenReady(function(){if(!t.validate()){var e=t.get("fulfillmentMethod");e||(e="Physical"===t.get("goodsType")?c.Constants.FulfillmentMethods.SHIP:c.Constants.FulfillmentMethods.DIGITAL),t.apiAddToCart({options:t.getConfiguredOptions(),fulfillmentMethod:e,quantity:t.get("quantity")}).then(function(e){t.trigger("addedtocart",e)})}})},addToWishlist:function(){var t=this;this.whenReady(function(){t.validate()||t.apiAddToWishlist({customerAccountId:require.mozuData("user").accountId,quantity:t.get("quantity")}).then(function(e){t.trigger("addedtowishlist",e)})})},addToCartForPickup:function(t,e){var n=this;this.whenReady(function(){return n.apiAddToCartForPickup({fulfillmentLocationCode:t,fulfillmentMethod:c.Constants.FulfillmentMethods.PICKUP,quantity:e||1}).then(function(t){n.trigger("addedtocart",t)})})},onOptionChange:function(){this.isLoading(!0),this.updateConfiguration()},updateConfiguration:function(){var t=this.getConfiguredOptions();JSON.stringify(this.lastConfiguration)!==JSON.stringify(t)?(this.lastConfiguration=t,this.apiConfigure({options:t},{useExistingInstances:!0})):this.isLoading(!1)},parse:function(t){return t&&t.productCode&&!t.variationProductCode&&this.unset("variationProductCode"),t},toJSON:function(t){var e=n.MozuModel.prototype.toJSON.apply(this,arguments);return t&&t.helpers||(e.options=this.getConfiguredOptions({unabridged:!0})),t&&t.helpers&&("string"==typeof e.mfgPartNumber&&(e.mfgPartNumber=[e.mfgPartNumber]),"string"==typeof e.upc&&(e.upc=[e.upc]),e.bundledProducts&&0===e.bundledProducts.length&&delete e.bundledProducts),e}},{Constants:{FulfillmentMethods:{SHIP:"Ship",PICKUP:"Pickup",DIGITAL:"Digital"},FulfillmentTypes:{IN_STORE_PICKUP:"InStorePickup"},ProductUsage:{Configurable:"Configurable"}}}),d=n.MozuModel.extend({relations:{items:n.Collection.extend({model:c})}});return{Product:c,Option:u,ProductCollection:d}}),define("modules/models-orders",["underscore","modules/backbone-mozu","hyprlive","modules/models-product"],function(t,e,n,i){var r=e.MozuModel.extend({relations:{product:i.Product}}),s=e.Collection.extend({model:r}),o=e.MozuModel.extend({mozuType:"rma",relations:{items:s},dataTypes:{quantity:e.MozuModel.DataTypes.Int},defaults:{returnType:"Refund"},validation:{reason:{required:!0,msg:n.getLabel("enterReturnReason")},quantity:{min:1,msg:n.getLabel("enterReturnQuantity")},comments:{fn:function(t){return"Other"!==this.attributes.reason||t?void 0:n.getLabel("enterOtherComments")}}},toJSON:function(){var t=e.MozuModel.prototype.toJSON.apply(this,arguments);return t.reason&&t.quantity&&t.items&&t.items[0]&&!t.items[0].reason&&(t.items[0].reasons=[{reason:t.reason,quantity:t.quantity}],t.comments&&(t.items[0].notes=[{text:t.comments}])),delete t.reason,delete t.quantity,delete t.comments,t}}),a=e.MozuPagedCollection.extend({mozuType:"rmas",defaults:{pageSize:5},relations:{items:e.Collection.extend({model:o})}}),u=e.MozuModel.extend({mozuType:"order",relations:{items:s}}),l=e.MozuPagedCollection.extend({mozuType:"orders",defaults:{pageSize:5},relations:{items:e.Collection.extend({model:u}),rma:o},startReturn:function(t,e){var n=this.get("rma"),i=this.get("items").get(t).get("items").get(e);i&&(i=i.toJSON(),i.orderItemId=i.id,n.get("items").reset([i]),n.set({originalOrderId:t,returnType:"Refund"}))},clearReturn:function(){var t=this.get("rma");t.clear()},finishReturn:function(){var t,e=this;return!this.validate()&&(this.isLoading(!0),t=this.get("rma").apiCreate())?t.then(function(t){return e.isLoading(!1),e.trigger("returncreated",t.prop("id")),e.clearReturn(),t},function(){e.isLoading(!1)}):void 0}});return{OrderItem:r,RMA:o,RMACollection:a,Order:u,OrderCollection:l}}),define("modules/models-paymentmethods",["jquery","underscore","modules/backbone-mozu","hyprlive"],function(t,e,n,i){var r=n.MozuModel.extend({present:function(t,e){return this.selected?t?void 0:this.validation[e.split(".").pop()].msg||i.getLabel("genericRequired"):void 0}}),s={cardNumber:"cardNumberPartOrMask",cardNumberPart:"cardNumberPartOrMask",cardType:"paymentOrCardType",id:"paymentServiceCardId"},o={3:"AMEX",4:"VISA",5:"MC",6:"DISCOVER"},a=r.extend({mozuType:"creditcard",isCvvOptional:!1,validation:{paymentOrCardType:{fn:"present",msg:i.getLabel("cardTypeMissing")},cardNumberPartOrMask:{fn:"present",msg:i.getLabel("cardNumberMissing")},expireMonth:{fn:"expirationDateInPast"},expireYear:{fn:"expirationDateInPast"},nameOnCard:{fn:"present",msg:i.getLabel("cardNameMissing")},cvv:{fn:function(t,e){var n=e.split(".")[0],r=this.get(n);return r.get("isCvvOptional")?"":this.selected?t?void 0:i.getLabel("securityCodeMissing")||i.getLabel("genericRequired"):void 0}}},initialize:function(){var t=this;e.each(s,function(e,n){t.on("change:"+e,function(e,i){t.set(n,i,{silent:!0})}),t.on("change:"+n,function(e,i){t.set(n,i,{silent:!0})})}),this.detectCardType&&this.on("change:cardNumberPartOrMask",e.debounce(function(t,e){var n;e&&e.toString&&(n=e.toString().charAt(0)),n&&n in o&&t.set({paymentOrCardType:o[n]})},500))},dataTypes:{expireMonth:n.MozuModel.DataTypes.Int,expireYear:n.MozuModel.DataTypes.Int,isCardInfoSaved:n.MozuModel.DataTypes.Boolean},expirationDateInPast:function(){if(!this.selected)return void 0;var t,e,n,r=this.get("expireMonth"),s=this.get("expireYear");return isNaN(r)||isNaN(s)?!1:(t=new Date(s,r-1,1,0,0,0,0),e=new Date,e.setDate(1),e.setHours(0,0,0,0),n=t>=e,n?void 0:i.getLabel("cardExpInvalid"))},toJSON:function(t){var n=r.prototype.toJSON.apply(this);return!n.card||t&&t.helpers||delete n.card.cvv,e.each(s,function(t,e){!(t in n)&&e in n&&(n[t]=n[e]),!(e in n)&&t in n&&(n[e]=n[t])}),n}}),u=(r.extend({mozuType:"paypalpayment"}),r.extend({validation:{nameOnCheck:{fn:"present"},routingNumber:{fn:"present"},checkNumber:{fn:"present"}}})),l=r.extend({isEnabled:!1,creditAmountApplied:null,remainingBalance:null,isTiedToCustomer:!0,addRemainderToCustomer:!1,initialize:function(){this.set({isEnabled:this.isEnabled}),this.set({creditAmountApplied:this.creditAmountApplied}),this.set({remainingBalance:this.remainingBalance}),this.set({isTiedToCustomer:this.isTiedToCustomer}),this.set({addRemainderToCustomer:this.addRemainderToCustomer})},helpers:["calculateRemainingBalance"],calculateRemainingBalance:function(){return this.get("creditAmountApplied")?this.get("currentBalance")-this.get("creditAmountApplied"):this.get("currentBalance")},validate:function(t){return t.creditAmountApplied&&t.creditAmountApplied>t.currentBalance?"Exceeds card balance.":void 0}});return{CreditCard:a,Check:u,DigitalCredit:l}}),define("modules/models-customer",["modules/backbone-mozu","underscore","modules/models-address","modules/models-orders","modules/models-paymentmethods","modules/models-product","hyprlive"],function(t,e,n,i,r,s,o){var a,u,l,c=require.mozuData("pagecontext");c&&c.shippingCountries&&c.billingCountries&&(a=e.pluck(c.shippingCountries,"value"),u=e.pluck(c.billingCountries,"value"),l=e.intersection(a,u));var d=["Billing","Shipping"],h={};e.each(d,function(t){h["change:is"+t+"Contact"]=function(n,i){var r=this.get("types");r=r?JSON.parse(JSON.stringify(r)):[];var s={name:t},o=e.findWhere(r,s);i&&!o&&(r.push(s),this.set("types",r,{silent:!0})),!i&&o&&this.set("types",e.without(r,o),{silent:!0})},h["change:isPrimary"+t+"Contact"]=function(n,i){var r=this.get("types"),s={name:t},o=e.findWhere(r,s);o&&(o.isPrimary=i,this.set("types",r,{silent:!0}))}});var p=t.MozuModel.extend({mozuType:"contact",relations:{address:n.StreetAddress,phoneNumbers:n.PhoneNumbers},validation:{firstName:{required:!0,msg:o.getLabel("firstNameMissing")},lastNameOrSurname:{required:!0,msg:o.getLabel("lastNameMissing")},"address.countryCode":{fn:function(t){if(!a)return void 0;
var n=this.attributes.isBillingContact||this.attributes.editingContact.attributes.isBillingContact,i=this.attributes.isShippingContact||this.attributes.editingContact.attributes.isShippingContact,r=n&&i&&l||n&&u||i&&a;return r&&!e.contains(r,t)?o.getLabel("wrongCountryForType"):void 0}}},toJSON:function(n){var i=t.MozuModel.prototype.toJSON.apply(this,arguments);return n&&n.helpers||e.each(d,function(t){delete i["is"+t+"Contact"],delete i["isPrimary"+t+"Contact"]}),"new"===i.id&&delete i.id,i},save:function(){if(!this.parent.validate("editingContact")){var t=this.get("id");return this.get("email")||this.set({email:this.parent.get("emailAddress")},{silent:!0}),t?this.apiUpdate():this.apiCreate()}},setTypeHelpers:function(t,n){var i=this;e.each(d,function(t){i.unset("is"+t+"Contact"),i.unset("isPrimary"+t+"Contact"),e.each(n,function(e){var n={};e.name===t&&(n["is"+t+"Contact"]=!0,e.isPrimary&&(n["isPrimary"+t+"Contact"]=!0),i.set(n,{silent:!0}))})})},initialize:function(){var t=this.get("types");t&&this.setTypeHelpers(null,t),this.on(h),this.on("change:types",this.setTypeHelpers,this)}}),f=t.MozuModel.extend({relations:{product:s.Product}}),g=t.MozuModel.extend({mozuType:"wishlist",helpers:["hasItems"],hasItems:function(){return this.get("items").length>0},relations:{items:t.Collection.extend({model:f})},addItemToCart:function(t){var e=this;return this.apiAddItemToCartById(t).then(function(n){return e.trigger("addedtocart",n,t),n})}}),m=t.MozuModel.extend({mozuType:"customer",helpers:["hasSavedCards","hasSavedContacts"],hasSavedCards:function(){var t=this.get("cards");return t&&t.length>0},hasSavedContacts:function(){var t=this.get("contacts");return t&&t.length>0},relations:{contacts:t.Collection.extend({model:p}),cards:t.Collection.extend({model:r.CreditCard}),credits:t.Collection.extend({model:r.DigitalCredit})},getPrimaryContactOfType:function(t){return this.get("contacts").find(function(n){return!!e.findWhere(n.get("types"),{name:t,isPrimary:!0})})},getPrimaryBillingContact:function(){return this.getPrimaryContactOfType("Billing")},getPrimaryShippingContact:function(){return this.getPrimaryContactOfType("Shipping")},getContacts:function(){var t=this,e=this.get("contacts");return this.apiGetContacts().then(function(n){return e.reset(n.data.items),t.trigger("sync",n.data),t})},getStoreCredits:function(){var t=this;return this.apiGetCredits().then(function(e){return t.set("credits",e.data.items),t.trigger("sync",e),t})},addStoreCredit:function(t){return this.apiAddStoreCredit(t)}}),v=r.CreditCard.extend({validation:e.extend({contactId:{required:!0,msg:o.getLabel("cardBillingMissing")}},r.CreditCard.prototype.validation),selected:!0,isCvvOptional:!0}),y=m.extend({handlesMessages:!0,relations:e.extend({editingCard:v,editingContact:p,wishlist:g,orderHistory:i.OrderCollection,returnHistory:i.RMACollection},m.prototype.relations),validation:{password:{fn:function(t){return this.validatePassword&&!t?o.getLabel("passwordMissing"):void 0}},confirmPassword:{fn:function(t){return this.validatePassword&&t!==this.get("password")?o.getLabel("passwordsDoNotMatch"):void 0}}},defaults:{editingCard:{},editingContact:{}},initialize:function(){var t=this.get("orderHistory"),e=this.get("returnHistory");this.get("editingContact").set("accountId",this.get("id")),t.lastRequest={pageSize:5},e.lastRequest={pageSize:5},t.on("returncreated",function(t){e.apiGet(e.lastRequest).then(function(){e.trigger("returndisplayed",t)})})},changePassword:function(){var t=this;return t.validatePassword=!0,this.validate("password")||this.validate("confirmPassword")?!1:this.apiChangePassword({oldPassword:this.get("oldPassword"),newPassword:this.get("password")}).ensure(function(){t.validatePassword=!1})},beginEditCard:function(t){var n=this.get("cards").get(t),i=this.get("contacts").toJSON(),r={contacts:i,hasSavedContacts:this.hasSavedContacts(),isCvvOptional:!0};n&&e.extend(r,n.toJSON({helpers:!0})),this.get("editingCard").set(r)},endEditCard:function(){this.get("editingCard").clear({silent:!0})},saveCard:function(){if(!this.validate("editingCard")){var t=this,e=this.get("editingCard").toJSON(),n=function(){return t.apiSavePaymentCard(e).then(function(){return t.getCards()}).then(function(){return t.get("editingCard").clear({silent:!0})})},i=function(){t.get("editingContact").set("isBillingContact",!0);var n=t.get("editingContact").save();if(!n)throw new Error("Could not save contact!");return n.then(function(n){return e.contactId=n.prop("id"),t.endEditContact(),t.getContacts(),!0})};return e.contactId&&"new"!==e.contactId?n():i().then(n)}},deleteCard:function(t){var e=this;return this.apiModel.deletePaymentCard(t).then(function(){return e.getCards()})},deleteMultipleCards:function(t){return this.apiModel.api.all.apply(this.apiModel.api,t.map(e.bind(this.apiModel.deletePaymentCard,this.apiModel))).then(e.bind(this.getCards,this))},getCards:function(){var t=this,e=this.get("cards");return this.syncApiModel(),this.apiModel.getCards().then(function(n){return e.set(n.data.items),t})},beginEditContact:function(t){var e=this.get("contacts").get(t);e&&this.get("editingContact").set(e.toJSON({helpers:!0,ensureCopy:!0}))},endEditContact:function(){var t=this.get("editingContact");t.clear(),t.set("accountId",this.get("id"))},saveContact:function(t){var e,n=this,i=this.get("editingContact");t&&t.forceIsValid&&i.set("address.isValidated",!0);var r=i.save();return r?r.then(function(t){return e=t,n.endEditContact(),n.getContacts()}).then(function(){return e}):void 0},deleteContact:function(t){var e=this;return this.apiModel.deleteContact(t).then(function(){return e.getContacts()})},updateName:function(){return this.apiUpdate({firstName:this.get("firstName"),lastName:this.get("lastName")})},updateAcceptsMarketing:function(t){return this.apiUpdate({acceptsMarketing:t})},toJSON:function(t){var e=m.prototype.toJSON.apply(this,arguments);return t&&t.helpers||delete e.customer,delete e.password,delete e.confirmPassword,delete e.oldPassword,e}});return{Contact:p,Customer:m,EditableCustomer:y}}),define("modules/models-documents",["modules/backbone-mozu","underscore","hyprlivecontext"],function(t,e,n,i){var r=(i.locals,t.MozuModel.extend({helpers:["url"],url:function(){return"/cms/"+this.get("id")}})),s=t.MozuPagedCollection.extend({relations:{items:t.Collection.extend({model:r})},buildPagingRequest:function(){var t=this.baseRequestParams?e.clone(this.baseRequestParams):{},n=this.get("pageSize"),i=this.get("startIndex"),r=this.filter,s=this.query;return t.pageSize=n,i&&(t.startIndex=i),r&&(t.filter=r),s&&(t.query=this.query),t},initialize:function(){this.lastRequest=this.buildPagingRequest()}});return{Document:r,DocumentCollection:s}}),define("modules/models-faceting",["modules/jquery-mozu","underscore","hyprlive","modules/backbone-mozu","modules/models-product"],function(t,e,n,i,r){var s=i.MozuModel.extend({idAttribute:"value"}),o=i.MozuModel.extend({idAttribute:"field",helpers:["isFaceted"],defaults:{facetType:"",field:"",label:""},relations:{values:i.Collection.extend({model:s})},isFaceted:function(){return!!this.get("values").findWhere({isApplied:!0})},empty:function(){this.set("values",{isApplied:!1}),this.collection.parent.updateFacets({resetIndex:!0})},getAppliedValues:function(){return e.invoke(this.get("values").where({isApplied:!0}),"get","filterValue").join(",")}}),a=i.MozuPagedCollection.extend({mozuType:"search",relations:{facets:i.Collection.extend({model:o}),items:i.Collection.extend({model:r.Product})},helpers:["hasValueFacets"],hierarchyDepth:2,hierarchyField:"categoryId",getQueryString:function(){var t=i.MozuPagedCollection.prototype.getQueryString.apply(this,arguments)||"",e=this.hierarchyValue&&window.encodeURIComponent(this.hierarchyField)+"="+window.encodeURIComponent(this.hierarchyValue);return e?t?t+"&"+e:"?"+e:t},buildRequest:function(t){var e=i.MozuPagedCollection.prototype.buildRequest.apply(this,arguments);return t=t||this.getFacetValueFilter(),t&&(e.facetValueFilter=t),e},setQuery:function(t){this.query=t,this.hierarchyValue||this.baseRequestParams||(this.baseRequestParams={facet:this.hierarchyField,facetHierDepth:this.hierarchyField+":"+this.hierarchyDepth,query:t}),this.lastRequest=this.buildRequest()},setHierarchy:function(t,n){this.hierarchyField=t,this.hierarchyValue=n,this.baseRequestParams=this.baseRequestParams||{},this.baseRequestParams=n||0===n?e.extend(this.baseRequestParams,{filter:t+" req "+n,facetTemplate:t+":"+n,facetHierValue:t+":"+n,facetHierDepth:t+":"+this.hierarchyDepth}):e.omit(this.baseRequestParams,"filter","facetTemplate","facetHierValue","facetHierDepth"),this.query&&(this.baseRequestParams.query=this.query),this.lastRequest=this.buildRequest()},hasValueFacets:function(){return!!this.get("facets").findWhere({facetType:"Value"})},clearAllFacets:function(){this.get("facets").invoke("empty")},getFacetValueFilter:function(){return e.compact(this.get("facets").invoke("getAppliedValues")).join(",")},setFacetValue:function(t,e,n){var i=this.get("facets").findWhere({field:t}).get("values"),r=i.findWhere({value:e})||i.findWhere({value:e.toString()});r.set("isApplied",n),this.updateFacets({resetIndex:!0})},updateFacets:function(t){var n,i=this;t=t||{},t.resetIndex&&this.set("startIndex",0),n=this.buildRequest(t.facetValueFilter),(t.force||!e.isEqual(n,this.lastRequest))&&(this.lastRequest=n,this.isLoading(!0),this.get("facets").reset(null,{silent:!0}),this.get("items").reset(null,{silent:!0}),this.apiModel.get(n).ensure(function(){i.isLoading(!1)}))},initialize:function(){var t=this;i.MozuPagedCollection.prototype.initialize.apply(this,arguments),this.updateFacets=e.debounce(this.updateFacets,300),this.on("sync",function(){t.trigger("facetchange",t.getQueryString())})}});return{Facet:o,FacetValue:s,FacetedProductCollection:a}}),define("shim!vendor/bootstrap/js/affix[jquery=jQuery]",["jquery"],function(t){return+function(t){function e(e){return this.each(function(){var i=t(this),r=i.data("bs.affix"),s="object"==typeof e&&e;r||i.data("bs.affix",r=new n(this,s)),"string"==typeof e&&r[e]()})}var n=function(e,i){this.options=t.extend({},n.DEFAULTS,i),this.$target=t(this.options.target).on("scroll.bs.affix.data-api",t.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",t.proxy(this.checkPositionWithEventLoop,this)),this.$element=t(e),this.affixed=this.unpin=this.pinnedOffset=null,this.checkPosition()};n.VERSION="3.2.0",n.RESET="affix affix-top affix-bottom",n.DEFAULTS={offset:0,target:window},n.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(n.RESET).addClass("affix");var t=this.$target.scrollTop(),e=this.$element.offset();return this.pinnedOffset=e.top-t},n.prototype.checkPositionWithEventLoop=function(){setTimeout(t.proxy(this.checkPosition,this),1)},n.prototype.checkPosition=function(){if(this.$element.is(":visible")){var e=t(document).height(),i=this.$target.scrollTop(),r=this.$element.offset(),s=this.options.offset,o=s.top,a=s.bottom;"object"!=typeof s&&(a=o=s),"function"==typeof o&&(o=s.top(this.$element)),"function"==typeof a&&(a=s.bottom(this.$element));var u=null!=this.unpin&&i+this.unpin<=r.top?!1:null!=a&&r.top+this.$element.height()>=e-a?"bottom":null!=o&&o>=i?"top":!1;if(this.affixed!==u){null!=this.unpin&&this.$element.css("top","");var l="affix"+(u?"-"+u:""),c=t.Event(l+".bs.affix");this.$element.trigger(c),c.isDefaultPrevented()||(this.affixed=u,this.unpin="bottom"==u?this.getPinnedOffset():null,this.$element.removeClass(n.RESET).addClass(l).trigger(t.Event(l.replace("affix","affixed"))),"bottom"==u&&this.$element.offset({top:e-this.$element.height()-a}))}}};var i=t.fn.affix;t.fn.affix=e,t.fn.affix.Constructor=n,t.fn.affix.noConflict=function(){return t.fn.affix=i,this},t(window).on("load",function(){t('[data-spy="affix"]').each(function(){var n=t(this),i=n.data();i.offset=i.offset||{},i.offsetBottom&&(i.offset.bottom=i.offsetBottom),i.offsetTop&&(i.offset.top=i.offsetTop),e.call(n,i)})})}(t),null}),define("shim!vendor/bootstrap/js/scrollspy[jquery=jQuery]",["jquery"],function(t){return+function(t){function e(n,i){var r=t.proxy(this.process,this);this.$body=t("body"),this.$scrollElement=t(n).is("body")?t(window):t(n),this.options=t.extend({},e.DEFAULTS,i),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",r),this.refresh(),this.process()}function n(n){return this.each(function(){var i=t(this),r=i.data("bs.scrollspy"),s="object"==typeof n&&n;r||i.data("bs.scrollspy",r=new e(this,s)),"string"==typeof n&&r[n]()})}e.VERSION="3.2.0",e.DEFAULTS={offset:10},e.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},e.prototype.refresh=function(){var e="offset",n=0;t.isWindow(this.$scrollElement[0])||(e="position",n=this.$scrollElement.scrollTop()),this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight();var i=this;this.$body.find(this.selector).map(function(){var i=t(this),r=i.data("target")||i.attr("href"),s=/^#./.test(r)&&t(r);return s&&s.length&&s.is(":visible")&&[[s[e]().top+n,r]]||null}).sort(function(t,e){return t[0]-e[0]}).each(function(){i.offsets.push(this[0]),i.targets.push(this[1])})},e.prototype.process=function(){var t,e=this.$scrollElement.scrollTop()+this.options.offset,n=this.getScrollHeight(),i=this.options.offset+n-this.$scrollElement.height(),r=this.offsets,s=this.targets,o=this.activeTarget;if(this.scrollHeight!=n&&this.refresh(),e>=i)return o!=(t=s[s.length-1])&&this.activate(t);if(o&&e<=r[0])return o!=(t=s[0])&&this.activate(t);for(t=r.length;t--;)o!=s[t]&&e>=r[t]&&(!r[t+1]||e<=r[t+1])&&this.activate(s[t])},e.prototype.activate=function(e){this.activeTarget=e,t(this.selector).parentsUntil(this.options.target,".active").removeClass("active");var n=this.selector+'[data-target="'+e+'"],'+this.selector+'[href="'+e+'"]',i=t(n).parents("li").addClass("active");i.parent(".dropdown-menu").length&&(i=i.closest("li.dropdown").addClass("active")),i.trigger("activate.bs.scrollspy")};var i=t.fn.scrollspy;t.fn.scrollspy=n,t.fn.scrollspy.Constructor=e,t.fn.scrollspy.noConflict=function(){return t.fn.scrollspy=i,this},t(window).on("load.bs.scrollspy.data-api",function(){t('[data-spy="scroll"]').each(function(){var e=t(this);n.call(e,e.data())})})}(t),null}),define("modules/scroll-nav",["modules/jquery-mozu","hyprlive","underscore","modules/api","shim!vendor/bootstrap/js/affix[jquery=jQuery]","shim!vendor/bootstrap/js/scrollspy[jquery=jQuery]"],function(t,e,n,i){if(!Modernizr.mq("(max-width: 800px)")){var r=parseInt(e.getThemeSetting("gutterWidth"),10);t(document).ready(function(){t("[data-mz-scrollnav]").each(function(){var e=t(this),s=t(e.data("mzScrollnav")),o=n.debounce(function(){s.scrollspy("refresh")},500);e.on("click","a",function(e){e.preventDefault(),t(this.getAttribute("href")).ScrollTo({axis:"y",offsetTop:r})}).affix({offset:{top:e.offset().top-r,bottom:0}}),t(window).on("resize",o),i.on("sync",o),i.on("spawn",o);var a=e.attr("id");a||(a="scrollnav-"+(new Date).getTime(),e.attr("id",a)),s.scrollspy({target:"#"+a,offset:1.2*r})})})}}),define("shim!vendor/typeahead.js/typeahead.bundle[modules/jquery-mozu=jQuery]>jQuery",["modules/jquery-mozu"],function(t){return function(t){var e=function(){return{isMsie:function(){return/(msie|trident)/i.test(navigator.userAgent)?navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]:!1},isBlankString:function(t){return!t||/^\s*$/.test(t)},escapeRegExChars:function(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isArray:t.isArray,isFunction:t.isFunction,isObject:t.isPlainObject,isUndefined:function(t){return"undefined"==typeof t},toStr:function(t){return e.isUndefined(t)||null===t?"":t+""},bind:t.proxy,each:function(e,n){function i(t,e){return n(e,t)}t.each(e,i)},map:t.map,filter:t.grep,every:function(e,n){var i=!0;return e?(t.each(e,function(t,r){return(i=n.call(null,r,t,e))?void 0:!1}),!!i):i},some:function(e,n){var i=!1;return e?(t.each(e,function(t,r){return(i=n.call(null,r,t,e))?!1:void 0}),!!i):i},mixin:t.extend,getUniqueId:function(){var t=0;return function(){return t++}}(),templatify:function(e){function n(){return String(e)}return t.isFunction(e)?e:n},defer:function(t){setTimeout(t,0)},debounce:function(t,e,n){var i,r;return function(){var s,o,a=this,u=arguments;return s=function(){i=null,n||(r=t.apply(a,u))},o=n&&!i,clearTimeout(i),i=setTimeout(s,e),o&&(r=t.apply(a,u)),r}},throttle:function(t,e){var n,i,r,s,o,a;return o=0,a=function(){o=new Date,r=null,s=t.apply(n,i)},function(){var u=new Date,l=e-(u-o);return n=this,i=arguments,0>=l?(clearTimeout(r),r=null,o=u,s=t.apply(n,i)):r||(r=setTimeout(a,l)),s}},noop:function(){}}}(),n="0.10.4",i=function(){function t(t){return t=e.toStr(t),t?t.split(/\s+/):[]}function n(t){return t=e.toStr(t),t?t.split(/\W+/):[]}function i(t){return function(){var n=[].slice.call(arguments,0);return function(i){var r=[];return e.each(n,function(n){r=r.concat(t(e.toStr(i[n])))}),r}}}return{nonword:n,whitespace:t,obj:{nonword:i(n),whitespace:i(t)}}}(),r=function(){function n(n){this.maxSize=e.isNumber(n)?n:100,this.reset(),this.maxSize<=0&&(this.set=this.get=t.noop)}function i(){this.head=this.tail=null}function r(t,e){this.key=t,this.val=e,this.prev=this.next=null}return e.mixin(n.prototype,{set:function(t,e){var n,i=this.list.tail;this.size>=this.maxSize&&(this.list.remove(i),delete this.hash[i.key]),(n=this.hash[t])?(n.val=e,this.list.moveToFront(n)):(n=new r(t,e),this.list.add(n),this.hash[t]=n,this.size++)},get:function(t){var e=this.hash[t];return e?(this.list.moveToFront(e),e.val):void 0},reset:function(){this.size=0,this.hash={},this.list=new i}}),e.mixin(i.prototype,{add:function(t){this.head&&(t.next=this.head,this.head.prev=t),this.head=t,this.tail=this.tail||t},remove:function(t){t.prev?t.prev.next=t.next:this.head=t.next,t.next?t.next.prev=t.prev:this.tail=t.prev},moveToFront:function(t){this.remove(t),this.add(t)}}),n}(),s=function(){function t(t){this.prefix=["__",t,"__"].join(""),this.ttlKey="__ttl__",this.keyMatcher=new RegExp("^"+e.escapeRegExChars(this.prefix))}function n(){return(new Date).getTime()}function i(t){return JSON.stringify(e.isUndefined(t)?null:t)}function r(t){return JSON.parse(t)}var s,o;try{s=window.localStorage,s.setItem("~~~","!"),s.removeItem("~~~")}catch(a){s=null}return o=s&&window.JSON?{_prefix:function(t){return this.prefix+t},_ttlKey:function(t){return this._prefix(t)+this.ttlKey},get:function(t){return this.isExpired(t)&&this.remove(t),r(s.getItem(this._prefix(t)))},set:function(t,r,o){return e.isNumber(o)?s.setItem(this._ttlKey(t),i(n()+o)):s.removeItem(this._ttlKey(t)),s.setItem(this._prefix(t),i(r))},remove:function(t){return s.removeItem(this._ttlKey(t)),s.removeItem(this._prefix(t)),this},clear:function(){var t,e,n=[],i=s.length;for(t=0;i>t;t++)(e=s.key(t)).match(this.keyMatcher)&&n.push(e.replace(this.keyMatcher,""));for(t=n.length;t--;)this.remove(n[t]);return this},isExpired:function(t){var i=r(s.getItem(this._ttlKey(t)));return e.isNumber(i)&&n()>i?!0:!1}}:{get:e.noop,set:e.noop,remove:e.noop,clear:e.noop,isExpired:e.noop},e.mixin(t.prototype,o),t}(),o=function(){function n(e){e=e||{},this.cancelled=!1,this.lastUrl=null,this._send=e.transport?i(e.transport):t.ajax,this._get=e.rateLimiter?e.rateLimiter(this._get):this._get,this._cache=e.cache===!1?new r(0):u}function i(n){return function(i,r){function s(t){e.defer(function(){a.resolve(t)})}function o(t){e.defer(function(){a.reject(t)})}var a=t.Deferred();return n(i,r,s,o),a}}var s=0,o={},a=6,u=new r(10);return n.setMaxPendingRequests=function(t){a=t},n.resetCache=function(){u.reset()},e.mixin(n.prototype,{_get:function(t,e,n){function i(e){n&&n(null,e),c._cache.set(t,e)}function r(){n&&n(!0)}function u(){s--,delete o[t],c.onDeckRequestArgs&&(c._get.apply(c,c.onDeckRequestArgs),c.onDeckRequestArgs=null)}var l,c=this;this.cancelled||t!==this.lastUrl||((l=o[t])?l.done(i).fail(r):a>s?(s++,o[t]=this._send(t,e).done(i).fail(r).always(u)):this.onDeckRequestArgs=[].slice.call(arguments,0))},get:function(t,n,i){var r;return e.isFunction(n)&&(i=n,n={}),this.cancelled=!1,this.lastUrl=t,(r=this._cache.get(t))?e.defer(function(){i&&i(null,r)}):this._get(t,n,i),!!r},cancel:function(){this.cancelled=!0}}),n}(),a=function(){function n(e){e=e||{},e.datumTokenizer&&e.queryTokenizer||t.error("datumTokenizer and queryTokenizer are both required"),this.datumTokenizer=e.datumTokenizer,this.queryTokenizer=e.queryTokenizer,this.reset()}function i(t){return t=e.filter(t,function(t){return!!t}),t=e.map(t,function(t){return t.toLowerCase()})}function r(){return{ids:[],children:{}}}function s(t){for(var e={},n=[],i=0,r=t.length;r>i;i++)e[t[i]]||(e[t[i]]=!0,n.push(t[i]));return n}function o(t,e){function n(t,e){return t-e}var i=0,r=0,s=[];t=t.sort(n),e=e.sort(n);for(var o=t.length,a=e.length;o>i&&a>r;)t[i]<e[r]?i++:t[i]>e[r]?r++:(s.push(t[i]),i++,r++);return s}return e.mixin(n.prototype,{bootstrap:function(t){this.datums=t.datums,this.trie=t.trie},add:function(t){var n=this;t=e.isArray(t)?t:[t],e.each(t,function(t){var s,o;s=n.datums.push(t)-1,o=i(n.datumTokenizer(t)),e.each(o,function(t){var e,i,o;for(e=n.trie,i=t.split("");o=i.shift();)e=e.children[o]||(e.children[o]=r()),e.ids.push(s)})})},get:function(t){var n,r,a=this;return n=i(this.queryTokenizer(t)),e.each(n,function(t){var e,n,i,s;if(r&&0===r.length)return!1;for(e=a.trie,n=t.split("");e&&(i=n.shift());)e=e.children[i];return e&&0===n.length?(s=e.ids.slice(0),r=r?o(r,s):s,void 0):(r=[],!1)}),r?e.map(s(r),function(t){return a.datums[t]}):[]},reset:function(){this.datums=[],this.trie=r()},serialize:function(){return{datums:this.datums,trie:this.trie}}}),n}(),u=function(){function i(t){return t.local||null}function r(i){var r,s;return s={url:null,thumbprint:"",ttl:864e5,filter:null,ajax:{}},(r=i.prefetch||null)&&(r=e.isString(r)?{url:r}:r,r=e.mixin(s,r),r.thumbprint=n+r.thumbprint,r.ajax.type=r.ajax.type||"GET",r.ajax.dataType=r.ajax.dataType||"json",!r.url&&t.error("prefetch requires url to be set")),r}function s(n){function i(t){return function(n){return e.debounce(n,t)}}function r(t){return function(n){return e.throttle(n,t)}}var s,o;return o={url:null,cache:!0,wildcard:"%QUERY",replace:null,rateLimitBy:"debounce",rateLimitWait:300,send:null,filter:null,ajax:{}},(s=n.remote||null)&&(s=e.isString(s)?{url:s}:s,s=e.mixin(o,s),s.rateLimiter=/^throttle$/i.test(s.rateLimitBy)?r(s.rateLimitWait):i(s.rateLimitWait),s.ajax.type=s.ajax.type||"GET",s.ajax.dataType=s.ajax.dataType||"json",delete s.rateLimitBy,delete s.rateLimitWait,!s.url&&t.error("remote requires url to be set")),s}return{local:i,prefetch:r,remote:s}}();!function(n){function r(e){e&&(e.local||e.prefetch||e.remote)||t.error("one of local, prefetch, or remote is required"),this.limit=e.limit||5,this.sorter=l(e.sorter),this.dupDetector=e.dupDetector||c,this.local=u.local(e),this.prefetch=u.prefetch(e),this.remote=u.remote(e),this.cacheKey=this.prefetch?this.prefetch.cacheKey||this.prefetch.url:null,this.index=new a({datumTokenizer:e.datumTokenizer,queryTokenizer:e.queryTokenizer}),this.storage=this.cacheKey?new s(this.cacheKey):null}function l(t){function n(e){return e.sort(t)}function i(t){return t}return e.isFunction(t)?n:i}function c(){return!1}var d,h;return d=n.Bloodhound,h={data:"data",protocol:"protocol",thumbprint:"thumbprint"},n.Bloodhound=r,r.noConflict=function(){return n.Bloodhound=d,r},r.tokenizers=i,e.mixin(r.prototype,{_loadPrefetch:function(e){function n(t){s.clear(),s.add(e.filter?e.filter(t):t),s._saveToStorage(s.index.serialize(),e.thumbprint,e.ttl)}var i,r,s=this;return(i=this._readFromStorage(e.thumbprint))?(this.index.bootstrap(i),r=t.Deferred().resolve()):r=t.ajax(e.url,e.ajax).done(n),r},_getFromRemote:function(t,e){function n(t,n){t?e([]):e(s.remote.filter?s.remote.filter(n):n)}var i,r,s=this;if(this.transport)return t=t||"",r=encodeURIComponent(t),i=this.remote.replace?this.remote.replace(this.remote.url,t):this.remote.url.replace(this.remote.wildcard,r),this.transport.get(i,this.remote.ajax,n)},_cancelLastRemoteRequest:function(){this.transport&&this.transport.cancel()},_saveToStorage:function(t,e,n){this.storage&&(this.storage.set(h.data,t,n),this.storage.set(h.protocol,location.protocol,n),this.storage.set(h.thumbprint,e,n))},_readFromStorage:function(t){var e,n={};return this.storage&&(n.data=this.storage.get(h.data),n.protocol=this.storage.get(h.protocol),n.thumbprint=this.storage.get(h.thumbprint)),e=n.thumbprint!==t||n.protocol!==location.protocol,n.data&&!e?n.data:null},_initialize:function(){function n(){r.add(e.isFunction(s)?s():s)}var i,r=this,s=this.local;return i=this.prefetch?this._loadPrefetch(this.prefetch):t.Deferred().resolve(),s&&i.done(n),this.transport=this.remote?new o(this.remote):null,this.initPromise=i.promise()},initialize:function(t){return!this.initPromise||t?this._initialize():this.initPromise},add:function(t){this.index.add(t)},get:function(t,n){function i(t){var i=s.slice(0);e.each(t,function(t){var n;return n=e.some(i,function(e){return r.dupDetector(t,e)}),!n&&i.push(t),i.length<r.limit}),n&&n(r.sorter(i))}var r=this,s=[],o=!1;s=this.index.get(t),s=this.sorter(s).slice(0,this.limit),s.length<this.limit?o=this._getFromRemote(t,i):this._cancelLastRemoteRequest(),o||(s.length>0||!this.transport)&&n&&n(s)},clear:function(){this.index.reset()},clearPrefetchCache:function(){this.storage&&this.storage.clear()},clearRemoteCache:function(){this.transport&&o.resetCache()},ttAdapter:function(){return e.bind(this.get,this)}}),r}(this);var l=function(){return{wrapper:'<span class="twitter-typeahead"></span>',dropdown:'<span class="tt-dropdown-menu"></span>',dataset:'<div class="tt-dataset-%CLASS%"></div>',suggestions:'<span class="tt-suggestions"></span>',suggestion:'<div class="tt-suggestion"></div>'}}(),c=function(){var t={wrapper:{position:"relative",display:"inline-block"},hint:{position:"absolute",top:"0",left:"0",borderColor:"transparent",boxShadow:"none",opacity:"1"},input:{position:"relative",verticalAlign:"top",backgroundColor:"transparent"},inputWithNoHint:{position:"relative",verticalAlign:"top"},dropdown:{position:"absolute",top:"100%",left:"0",zIndex:"100",display:"none"},suggestions:{display:"block"},suggestion:{whiteSpace:"nowrap",cursor:"pointer"},suggestionChild:{whiteSpace:"normal"},ltr:{left:"0",right:"auto"},rtl:{left:"auto",right:" 0"}};return e.isMsie()&&e.mixin(t.input,{backgroundImage:"url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)"}),e.isMsie()&&e.isMsie()<=7&&e.mixin(t.input,{marginTop:"-1px"}),t}(),d=function(){function n(e){e&&e.el||t.error("EventBus initialized without el"),this.$el=t(e.el)}var i="typeahead:";return e.mixin(n.prototype,{trigger:function(t){var e=[].slice.call(arguments,1);this.$el.trigger(i+t,e)}}),n}(),h=function(){function t(t,e,n,i){var r;if(!n)return this;for(e=e.split(u),n=i?a(n,i):n,this._callbacks=this._callbacks||{};r=e.shift();)this._callbacks[r]=this._callbacks[r]||{sync:[],async:[]},this._callbacks[r][t].push(n);return this}function e(e,n,i){return t.call(this,"async",e,n,i)}function n(e,n,i){return t.call(this,"sync",e,n,i)}function i(t){var e;if(!this._callbacks)return this;for(t=t.split(u);e=t.shift();)delete this._callbacks[e];return this}function r(t){var e,n,i,r,o;if(!this._callbacks)return this;for(t=t.split(u),i=[].slice.call(arguments,1);(e=t.shift())&&(n=this._callbacks[e]);)r=s(n.sync,this,[e].concat(i)),o=s(n.async,this,[e].concat(i)),r()&&l(o);return this}function s(t,e,n){function i(){for(var i,r=0,s=t.length;!i&&s>r;r+=1)i=t[r].apply(e,n)===!1;return!i}return i}function o(){var t;return t=window.setImmediate?function(t){setImmediate(function(){t()})}:function(t){setTimeout(function(){t()},0)}}function a(t,e){return t.bind?t.bind(e):function(){t.apply(e,[].slice.call(arguments,0))}}var u=/\s+/,l=o();return{onSync:n,onAsync:e,off:i,trigger:r}}(),p=function(t){function n(t,n,i){for(var r,s=[],o=0,a=t.length;a>o;o++)s.push(e.escapeRegExChars(t[o]));return r=i?"\\b("+s.join("|")+")\\b":"("+s.join("|")+")",n?new RegExp(r):new RegExp(r,"i")}var i={node:null,pattern:null,tagName:"strong",className:null,wordsOnly:!1,caseSensitive:!1};return function(r){function s(e){var n,i,s;return(n=a.exec(e.data))&&(s=t.createElement(r.tagName),r.className&&(s.className=r.className),i=e.splitText(n.index),i.splitText(n[0].length),s.appendChild(i.cloneNode(!0)),e.parentNode.replaceChild(s,i)),!!n}function o(t,e){for(var n,i=3,r=0;r<t.childNodes.length;r++)n=t.childNodes[r],n.nodeType===i?r+=e(n)?1:0:o(n,e)}var a;r=e.mixin({},i,r),r.node&&r.pattern&&(r.pattern=e.isArray(r.pattern)?r.pattern:[r.pattern],a=n(r.pattern,r.caseSensitive,r.wordsOnly),o(r.node,s))}}(window.document),f=function(){function n(n){var r,s,a,u,l=this;n=n||{},n.input||t.error("input is missing"),r=e.bind(this._onBlur,this),s=e.bind(this._onFocus,this),a=e.bind(this._onKeydown,this),u=e.bind(this._onInput,this),this.$hint=t(n.hint),this.$input=t(n.input).on("blur.tt",r).on("focus.tt",s).on("keydown.tt",a),0===this.$hint.length&&(this.setHint=this.getHint=this.clearHint=this.clearHintIfInvalid=e.noop),e.isMsie()?this.$input.on("keydown.tt keypress.tt cut.tt paste.tt",function(t){o[t.which||t.keyCode]||e.defer(e.bind(l._onInput,l,t))}):this.$input.on("input.tt",u),this.query=this.$input.val(),this.$overflowHelper=i(this.$input)}function i(e){return t('<pre aria-hidden="true"></pre>').css({position:"absolute",visibility:"hidden",whiteSpace:"pre",fontFamily:e.css("font-family"),fontSize:e.css("font-size"),fontStyle:e.css("font-style"),fontVariant:e.css("font-variant"),fontWeight:e.css("font-weight"),wordSpacing:e.css("word-spacing"),letterSpacing:e.css("letter-spacing"),textIndent:e.css("text-indent"),textRendering:e.css("text-rendering"),textTransform:e.css("text-transform")}).insertAfter(e)}function r(t,e){return n.normalizeQuery(t)===n.normalizeQuery(e)}function s(t){return t.altKey||t.ctrlKey||t.metaKey||t.shiftKey}var o;return o={9:"tab",27:"esc",37:"left",39:"right",13:"enter",38:"up",40:"down"},n.normalizeQuery=function(t){return(t||"").replace(/^\s*/g,"").replace(/\s{2,}/g," ")},e.mixin(n.prototype,h,{_onBlur:function(){this.resetInputValue(),this.trigger("blurred")},_onFocus:function(){this.trigger("focused")},_onKeydown:function(t){var e=o[t.which||t.keyCode];this._managePreventDefault(e,t),e&&this._shouldTrigger(e,t)&&this.trigger(e+"Keyed",t)},_onInput:function(){this._checkInputValue()},_managePreventDefault:function(t,e){var n,i,r;switch(t){case"tab":i=this.getHint(),r=this.getInputValue(),n=i&&i!==r&&!s(e);break;case"up":case"down":n=!s(e);break;default:n=!1}n&&e.preventDefault()},_shouldTrigger:function(t,e){var n;switch(t){case"tab":n=!s(e);break;default:n=!0}return n},_checkInputValue:function(){var t,e,n;t=this.getInputValue(),e=r(t,this.query),n=e?this.query.length!==t.length:!1,this.query=t,e?n&&this.trigger("whitespaceChanged",this.query):this.trigger("queryChanged",this.query)},focus:function(){this.$input.focus()},blur:function(){this.$input.blur()},getQuery:function(){return this.query},setQuery:function(t){this.query=t},getInputValue:function(){return this.$input.val()},setInputValue:function(t,e){this.$input.val(t),e?this.clearHint():this._checkInputValue()},resetInputValue:function(){this.setInputValue(this.query,!0)},getHint:function(){return this.$hint.val()},setHint:function(t){this.$hint.val(t)},clearHint:function(){this.setHint("")},clearHintIfInvalid:function(){var t,e,n,i;t=this.getInputValue(),e=this.getHint(),n=t!==e&&0===e.indexOf(t),i=""!==t&&n&&!this.hasOverflow(),!i&&this.clearHint()},getLanguageDirection:function(){return(this.$input.css("direction")||"ltr").toLowerCase()},hasOverflow:function(){var t=this.$input.width()-2;return this.$overflowHelper.text(this.getInputValue()),this.$overflowHelper.width()>=t
},isCursorAtEnd:function(){var t,n,i;return t=this.$input.val().length,n=this.$input[0].selectionStart,e.isNumber(n)?n===t:document.selection?(i=document.selection.createRange(),i.moveStart("character",-t),t===i.text.length):!0},destroy:function(){this.$hint.off(".tt"),this.$input.off(".tt"),this.$hint=this.$input=this.$overflowHelper=null}}),n}(),g=function(){function n(n){n=n||{},n.templates=n.templates||{},n.source||t.error("missing source"),n.name&&!s(n.name)&&t.error("invalid dataset name: "+n.name),this.query=null,this.highlight=!!n.highlight,this.name=n.name||e.getUniqueId(),this.source=n.source,this.displayFn=i(n.display||n.displayKey),this.templates=r(n.templates,this.displayFn),this.$el=t(l.dataset.replace("%CLASS%",this.name))}function i(t){function n(e){return e[t]}return t=t||"value",e.isFunction(t)?t:n}function r(t,n){function i(t){return"<p>"+n(t)+"</p>"}return{empty:t.empty&&e.templatify(t.empty),header:t.header&&e.templatify(t.header),footer:t.footer&&e.templatify(t.footer),suggestion:t.suggestion||i}}function s(t){return/^[_a-zA-Z0-9-]+$/.test(t)}var o="ttDataset",a="ttValue",u="ttDatum";return n.extractDatasetName=function(e){return t(e).data(o)},n.extractValue=function(e){return t(e).data(a)},n.extractDatum=function(e){return t(e).data(u)},e.mixin(n.prototype,h,{_render:function(n,i){function r(){return g.templates.empty({query:n,isEmpty:!0})}function s(){function r(e){var n;return n=t(l.suggestion).append(g.templates.suggestion(e)).data(o,g.name).data(a,g.displayFn(e)).data(u,e),n.children().each(function(){t(this).css(c.suggestionChild)}),n}var s,d;return s=t(l.suggestions).css(c.suggestions),d=e.map(i,r),s.append.apply(s,d),g.highlight&&p({className:"tt-highlight",node:s[0],pattern:n}),s}function d(){return g.templates.header({query:n,isEmpty:!f})}function h(){return g.templates.footer({query:n,isEmpty:!f})}if(this.$el){var f,g=this;this.$el.empty(),f=i&&i.length,!f&&this.templates.empty?this.$el.html(r()).prepend(g.templates.header?d():null).append(g.templates.footer?h():null):f&&this.$el.html(s()).prepend(g.templates.header?d():null).append(g.templates.footer?h():null),this.trigger("rendered")}},getRoot:function(){return this.$el},update:function(t){function e(e){n.canceled||t!==n.query||n._render(t,e)}var n=this;this.query=t,this.canceled=!1,this.source(t,e)},cancel:function(){this.canceled=!0},clear:function(){this.cancel(),this.$el.empty(),this.trigger("rendered")},isEmpty:function(){return this.$el.is(":empty")},destroy:function(){this.$el=null}}),n}(),m=function(){function n(n){var r,s,o,a=this;n=n||{},n.menu||t.error("menu is required"),this.isOpen=!1,this.isEmpty=!0,this.datasets=e.map(n.datasets,i),r=e.bind(this._onSuggestionClick,this),s=e.bind(this._onSuggestionMouseEnter,this),o=e.bind(this._onSuggestionMouseLeave,this),this.$menu=t(n.menu).on("click.tt",".tt-suggestion",r).on("mouseenter.tt",".tt-suggestion",s).on("mouseleave.tt",".tt-suggestion",o),e.each(this.datasets,function(t){a.$menu.append(t.getRoot()),t.onSync("rendered",a._onRendered,a)})}function i(t){return new g(t)}return e.mixin(n.prototype,h,{_onSuggestionClick:function(e){this.trigger("suggestionClicked",t(e.currentTarget))},_onSuggestionMouseEnter:function(e){this._removeCursor(),this._setCursor(t(e.currentTarget),!0)},_onSuggestionMouseLeave:function(){this._removeCursor()},_onRendered:function(){function t(t){return t.isEmpty()}this.isEmpty=e.every(this.datasets,t),this.isEmpty?this._hide():this.isOpen&&this._show(),this.trigger("datasetRendered")},_hide:function(){this.$menu.hide()},_show:function(){this.$menu.css("display","block")},_getSuggestions:function(){return this.$menu.find(".tt-suggestion")},_getCursor:function(){return this.$menu.find(".tt-cursor").first()},_setCursor:function(t,e){t.first().addClass("tt-cursor"),!e&&this.trigger("cursorMoved")},_removeCursor:function(){this._getCursor().removeClass("tt-cursor")},_moveCursor:function(t){var e,n,i,r;if(this.isOpen){if(n=this._getCursor(),e=this._getSuggestions(),this._removeCursor(),i=e.index(n)+t,i=(i+1)%(e.length+1)-1,-1===i)return this.trigger("cursorRemoved"),void 0;-1>i&&(i=e.length-1),this._setCursor(r=e.eq(i)),this._ensureVisible(r)}},_ensureVisible:function(t){var e,n,i,r;e=t.position().top,n=e+t.outerHeight(!0),i=this.$menu.scrollTop(),r=this.$menu.height()+parseInt(this.$menu.css("paddingTop"),10)+parseInt(this.$menu.css("paddingBottom"),10),0>e?this.$menu.scrollTop(i+e):n>r&&this.$menu.scrollTop(i+(n-r))},close:function(){this.isOpen&&(this.isOpen=!1,this._removeCursor(),this._hide(),this.trigger("closed"))},open:function(){this.isOpen||(this.isOpen=!0,!this.isEmpty&&this._show(),this.trigger("opened"))},setLanguageDirection:function(t){this.$menu.css("ltr"===t?c.ltr:c.rtl)},moveCursorUp:function(){this._moveCursor(-1)},moveCursorDown:function(){this._moveCursor(1)},getDatumForSuggestion:function(t){var e=null;return t.length&&(e={raw:g.extractDatum(t),value:g.extractValue(t),datasetName:g.extractDatasetName(t)}),e},getDatumForCursor:function(){return this.getDatumForSuggestion(this._getCursor().first())},getDatumForTopSuggestion:function(){return this.getDatumForSuggestion(this._getSuggestions().first())},update:function(t){function n(e){e.update(t)}e.each(this.datasets,n)},empty:function(){function t(t){t.clear()}e.each(this.datasets,t),this.isEmpty=!0},isVisible:function(){return this.isOpen&&!this.isEmpty},destroy:function(){function t(t){t.destroy()}this.$menu.off(".tt"),this.$menu=null,e.each(this.datasets,t)}}),n}(),v=function(){function n(n){var r,s,o;n=n||{},n.input||t.error("missing input"),this.isActivated=!1,this.autoselect=!!n.autoselect,this.minLength=e.isNumber(n.minLength)?n.minLength:1,this.$node=i(n.input,n.withHint),r=this.$node.find(".tt-dropdown-menu"),s=this.$node.find(".tt-input"),o=this.$node.find(".tt-hint"),s.on("blur.tt",function(t){var n,i,o;n=document.activeElement,i=r.is(n),o=r.has(n).length>0,e.isMsie()&&(i||o)&&(t.preventDefault(),t.stopImmediatePropagation(),e.defer(function(){s.focus()}))}),r.on("mousedown.tt",function(t){t.preventDefault()}),this.eventBus=n.eventBus||new d({el:s}),this.dropdown=new m({menu:r,datasets:n.datasets}).onSync("suggestionClicked",this._onSuggestionClicked,this).onSync("cursorMoved",this._onCursorMoved,this).onSync("cursorRemoved",this._onCursorRemoved,this).onSync("opened",this._onOpened,this).onSync("closed",this._onClosed,this).onAsync("datasetRendered",this._onDatasetRendered,this),this.input=new f({input:s,hint:o}).onSync("focused",this._onFocused,this).onSync("blurred",this._onBlurred,this).onSync("enterKeyed",this._onEnterKeyed,this).onSync("tabKeyed",this._onTabKeyed,this).onSync("escKeyed",this._onEscKeyed,this).onSync("upKeyed",this._onUpKeyed,this).onSync("downKeyed",this._onDownKeyed,this).onSync("leftKeyed",this._onLeftKeyed,this).onSync("rightKeyed",this._onRightKeyed,this).onSync("queryChanged",this._onQueryChanged,this).onSync("whitespaceChanged",this._onWhitespaceChanged,this),this._setLanguageDirection()}function i(e,n){var i,s,a,u;i=t(e),s=t(l.wrapper).css(c.wrapper),a=t(l.dropdown).css(c.dropdown),u=i.clone().css(c.hint).css(r(i)),u.val("").removeData().addClass("tt-hint").removeAttr("id name placeholder required").prop("readonly",!0).attr({autocomplete:"off",spellcheck:"false",tabindex:-1}),i.data(o,{dir:i.attr("dir"),autocomplete:i.attr("autocomplete"),spellcheck:i.attr("spellcheck"),style:i.attr("style")}),i.addClass("tt-input").attr({autocomplete:"off",spellcheck:!1}).css(n?c.input:c.inputWithNoHint);try{!i.attr("dir")&&i.attr("dir","auto")}catch(d){}return i.wrap(s).parent().prepend(n?u:null).append(a)}function r(t){return{backgroundAttachment:t.css("background-attachment"),backgroundClip:t.css("background-clip"),backgroundColor:t.css("background-color"),backgroundImage:t.css("background-image"),backgroundOrigin:t.css("background-origin"),backgroundPosition:t.css("background-position"),backgroundRepeat:t.css("background-repeat"),backgroundSize:t.css("background-size")}}function s(t){var n=t.find(".tt-input");e.each(n.data(o),function(t,i){e.isUndefined(t)?n.removeAttr(i):n.attr(i,t)}),n.detach().removeData(o).removeClass("tt-input").insertAfter(t),t.remove()}var o="ttAttrs";return e.mixin(n.prototype,{_onSuggestionClicked:function(t,e){var n;(n=this.dropdown.getDatumForSuggestion(e))&&this._select(n)},_onCursorMoved:function(){var t=this.dropdown.getDatumForCursor();this.input.setInputValue(t.value,!0),this.eventBus.trigger("cursorchanged",t.raw,t.datasetName)},_onCursorRemoved:function(){this.input.resetInputValue(),this._updateHint()},_onDatasetRendered:function(){this._updateHint()},_onOpened:function(){this._updateHint(),this.eventBus.trigger("opened")},_onClosed:function(){this.input.clearHint(),this.eventBus.trigger("closed")},_onFocused:function(){this.isActivated=!0,this.dropdown.open()},_onBlurred:function(){this.isActivated=!1,this.dropdown.empty(),this.dropdown.close()},_onEnterKeyed:function(t,e){var n,i;n=this.dropdown.getDatumForCursor(),i=this.dropdown.getDatumForTopSuggestion(),n?(this._select(n),e.preventDefault()):this.autoselect&&i&&(this._select(i),e.preventDefault())},_onTabKeyed:function(t,e){var n;(n=this.dropdown.getDatumForCursor())?(this._select(n),e.preventDefault()):this._autocomplete(!0)},_onEscKeyed:function(){this.dropdown.close(),this.input.resetInputValue()},_onUpKeyed:function(){var t=this.input.getQuery();this.dropdown.isEmpty&&t.length>=this.minLength?this.dropdown.update(t):this.dropdown.moveCursorUp(),this.dropdown.open()},_onDownKeyed:function(){var t=this.input.getQuery();this.dropdown.isEmpty&&t.length>=this.minLength?this.dropdown.update(t):this.dropdown.moveCursorDown(),this.dropdown.open()},_onLeftKeyed:function(){"rtl"===this.dir&&this._autocomplete()},_onRightKeyed:function(){"ltr"===this.dir&&this._autocomplete()},_onQueryChanged:function(t,e){this.input.clearHintIfInvalid(),e.length>=this.minLength?this.dropdown.update(e):this.dropdown.empty(),this.dropdown.open(),this._setLanguageDirection()},_onWhitespaceChanged:function(){this._updateHint(),this.dropdown.open()},_setLanguageDirection:function(){var t;this.dir!==(t=this.input.getLanguageDirection())&&(this.dir=t,this.$node.css("direction",t),this.dropdown.setLanguageDirection(t))},_updateHint:function(){var t,n,i,r,s,o;t=this.dropdown.getDatumForTopSuggestion(),t&&this.dropdown.isVisible()&&!this.input.hasOverflow()?(n=this.input.getInputValue(),i=f.normalizeQuery(n),r=e.escapeRegExChars(i),s=new RegExp("^(?:"+r+")(.+$)","i"),o=s.exec(t.value),o?this.input.setHint(n+o[1]):this.input.clearHint()):this.input.clearHint()},_autocomplete:function(t){var e,n,i,r;e=this.input.getHint(),n=this.input.getQuery(),i=t||this.input.isCursorAtEnd(),e&&n!==e&&i&&(r=this.dropdown.getDatumForTopSuggestion(),r&&this.input.setInputValue(r.value),this.eventBus.trigger("autocompleted",r.raw,r.datasetName))},_select:function(t){this.input.setQuery(t.value),this.input.setInputValue(t.value,!0),this._setLanguageDirection(),this.eventBus.trigger("selected",t.raw,t.datasetName),this.dropdown.close(),e.defer(e.bind(this.dropdown.empty,this.dropdown))},open:function(){this.dropdown.open()},close:function(){this.dropdown.close()},setVal:function(t){t=e.toStr(t),this.isActivated?this.input.setInputValue(t):(this.input.setQuery(t),this.input.setInputValue(t,!0)),this._setLanguageDirection()},getVal:function(){return this.input.getQuery()},destroy:function(){this.input.destroy(),this.dropdown.destroy(),s(this.$node),this.$node=null}}),n}();!function(){var n,i,r;n=t.fn.typeahead,i="ttTypeahead",r={initialize:function(n,r){function s(){var s,o,a=t(this);e.each(r,function(t){t.highlight=!!n.highlight}),o=new v({input:a,eventBus:s=new d({el:a}),withHint:e.isUndefined(n.hint)?!0:!!n.hint,minLength:n.minLength,autoselect:n.autoselect,datasets:r}),a.data(i,o)}return r=e.isArray(r)?r:[].slice.call(arguments,1),n=n||{},this.each(s)},open:function(){function e(){var e,n=t(this);(e=n.data(i))&&e.open()}return this.each(e)},close:function(){function e(){var e,n=t(this);(e=n.data(i))&&e.close()}return this.each(e)},val:function(e){function n(){var n,r=t(this);(n=r.data(i))&&n.setVal(e)}function r(t){var e,n;return(e=t.data(i))&&(n=e.getVal()),n}return arguments.length?this.each(n):r(this.first())},destroy:function(){function e(){var e,n=t(this);(e=n.data(i))&&(e.destroy(),n.removeData(i))}return this.each(e)}},t.fn.typeahead=function(e){var n;return r[e]&&"initialize"!==e?(n=this.filter(function(){return!!t(this).data(i)}),r[e].apply(n,[].slice.call(arguments,1))):r.initialize.apply(this,arguments)},t.fn.typeahead.noConflict=function(){return t.fn.typeahead=n,this}}()}(window.jQuery),t}),define("modules/search-autocomplete",["shim!vendor/typeahead.js/typeahead.bundle[modules/jquery-mozu=jQuery]>jQuery","hyprlive","modules/api"],function(t,e,n){var i,r=window.Bloodhound.noConflict(),s="%QUERY",o=encodeURIComponent(s),a=function(t){return n.getActionConfig("suggest","get",{query:s,groups:t}).url},u=a("terms"),l=a("pages"),c={headers:n.getRequestHeaders()},d=/\W+/,h=function(t){return function(e){var n,r=e.suggestionGroups;for(i=r.length-1;i>=0;i--)if(r[i].name===t){n=r[i];break}return n.suggestions}},p=function(t){var n=e.getTemplate(t);return function(t){return n.render(t)}},f={datasets:{terms:new r({datumTokenizer:function(t){return t.suggestion.term.split(d)},queryTokenizer:r.tokenizers.whitespace,remote:{url:u,wildcard:o,filter:h("Terms"),rateLimitWait:100,ajax:c}}),pages:new r({datumTokenizer:function(t){return t.suggestion.term.split(d)},queryTokenizer:r.tokenizers.whitespace,remote:{url:l,wildcard:o,filter:h("Pages"),rateLimitWait:400,ajax:c}})}};return t.each(f.datasets,function(t,e){e.initialize()}),t(document).ready(function(){var e=f.$typeaheadField=t('[data-mz-role="searchquery"]');f.typeaheadInstance=e.typeahead({minLength:3},{name:"terms",displayKey:function(t){return t.suggestion.term},source:f.datasets.terms.ttAdapter()},{name:"pages",displayKey:function(t){return t.suggestion.productCode},templates:{suggestion:p("modules/search/autocomplete-page-result")},source:f.datasets.pages.ttAdapter()}).data("ttTypeahead"),e.on("typeahead:selected",function(t,e){e.suggestion.productCode&&(window.location="/p/"+e.suggestion.productCode)})}),f}),define("modules/views-productlists",["modules/jquery-mozu","underscore","modules/backbone-mozu","hyprlive"],function(t,e,n){var i=n.MozuView.extend({templateName:"modules/product/product-list-tiled"}),r=n.MozuView.extend({additionalEvents:{"change [data-mz-facet-value]":"setFacetValue"},templateName:"modules/product/faceting-form",initialize:function(){this.listenTo(this.model,"loadingchange",function(t){this.$el.find("input").prop("disabled",t)})},clearFacets:function(){this.model.clearAllFacets()},clearFacet:function(e){this.model.get("facets").findWhere({field:t(e.currentTarget).data("mz-facet")}).empty()},drillDown:function(e){var n=t(e.currentTarget),i=n.data("mz-hierarchy-id"),r=n.data("mz-facet");this.model.setHierarchy(r,i),this.model.updateFacets({force:!0,resetIndex:!0}),e.preventDefault()},setFacetValue:function(e){var n=t(e.currentTarget);this.model.setFacetValue(n.data("mz-facet"),n.data("mz-facet-value"),n.is(":checked"))}});return{List:i,FacetingPanel:r}}),define("modules/views-paging",["modules/jquery-mozu","underscore","modules/backbone-mozu"],function(t,e,n){var i=n.MozuView.extend({initialize:function(){var t=this;if(!this.model._isPaged)throw"Cannot bind a Paging view to a model that does not have the Paging mixin!";n.history.on("route",function(){t.model.syncIndex(n.history.fragment)})},render:function(){n.MozuView.prototype.render.apply(this,arguments),this.$("select").each(function(){var e=t(this);e.val(e.find("option[selected]").val())})}}),r=i.extend({templateName:"modules/common/paging-controls",autoUpdate:["pageSize"],updatePageSize:function(e){var n=parseInt(t(e.currentTarget).val(),10),i=this.model.get("pageSize");if(isNaN(n))throw new SyntaxError("Cannot set page size to a non-number!");n!==i&&(this.model.set("pageSize",n),this.model.set("startIndex",0))}}),s=i.extend({templateName:"modules/common/page-numbers",previous:function(t){return t.preventDefault(),this.model.previousPage()},next:function(t){return t.preventDefault(),this.model.nextPage()},page:function(e){return e.preventDefault(),this.model.setPage(parseInt(t(e.currentTarget).data("mz-page-num"),10)||1)}}),o=function(){t("body").ScrollTo({duration:200})},a=s.extend({previous:function(){return s.prototype.previous.apply(this,arguments).then(o)},next:function(){return s.prototype.next.apply(this,arguments).then(o)},page:function(){return s.prototype.page.apply(this,arguments).then(o)}}),u=i.extend({templateName:"modules/common/page-sort",updateSortBy:function(e){return this.model.sortBy(t(e.currentTarget).val())}});return{PagingControls:r,PageNumbers:s,TopScrollingPageNumbers:a,PageSortView:u}}),define("widgets/powerreviews",["modules/jquery-mozu","hyprlive","modules/backbone-mozu","modules/models-product","modules/api","modules/models-orders"],function(t,e,n,i,r,s){function o(){t(".mz-productlist").append('<link rel="stylesheet" href="'+c+'" type="text/css" id="prBaseStylesheet">'),t(".mz-productlist").append('<link rel="stylesheet" href="'+d+'" type="text/css" id="prMerchantOverrideStylesheet">'),t(".mz-productlist").append('<link rel="stylesheet" href="/stylesheets/widgets/pr_category.css" type="text/css" id="prCategory">'),t(".mz-productlist").append('<link rel="stylesheet" href="/stylesheets/widgets/pr_category_styles_review_override.css" type="text/css" id="prCategoryBaseStylesheetOverride">');var e=t(".pr-inline-rating");r.get("entityList",{listName:"mozu-powerreviews-ratings@a0842dd",filter:"productCode  eq "+e.map(function(){return t(this).data("mzProductCode")}).get().join(" or productCode  eq ")}).then(function(n){var i=n.data.items.reduce(function(t,e){return t[e.productCode]=e,t},{});e.each(function(){var e=t(this);h=document.location;var n=e.data("mzProductCode"),r=i[n];if(r){var s,o=r.fullReviews;r.fullReviews>1?s="("+r.fullReviews+" reviews)":1==r.fullReviews&&(s="("+r.fullReviews+" review)"),r.averageDecimalRating>0&&r.merchantGrpId==a?(t("#PRInlineRating-"+n).show(),t("#PRInlineRating-"+n).find(".pr-snippet-write-review").show(),t("#PRInlineRating-"+n).find(".pr-snippet-read-reviews").show(),t("#PRInlineRating-"+n).find(".pr-snippet-write-review").find("a.pr-snippet-link").attr("href","/write-a-review?pageId="+n+"&merchantGroupId="+a+"&merchantId="+u+"&siteId="+f+"&zipLocation="+l+"&returlUrl="+h),t("#PRInlineRating-"+n).find(".pr-snippet-read-reviews").find("a.pr-snippet-link").find("#pr-snippet-read-review-count").text(o),t("#PRInlineRating-"+n).find("#pr-snippet-rating-decimal").text(r.averageDecimalRating),t("#PRInlineRating-"+n).find("#pr-snippet-review-count").text(s),t("#PRInlineRating-"+n).find("#pr-snippet-star-image").addClass("pr-stars").addClass("pr-stars-small").addClass("pr-stars-"+r.averageOverallRating+"-sm")):(t("#PRInlineRating-"+n).show(),t("#PRInlineRating-"+n).find(".pr-snippet-write-first-review").show(),t("#PRInlineRating-"+n).find(".pr-snippet-write-first-review").find("a.pr-snippet-link").attr("href","/write-a-review?pageId="+n+"&merchantGroupId="+a+"&merchantId="+u+"&siteId="+f+"&zipLocation="+l+"&returlUrl="+h),t("#PRInlineRating-"+n).find("#pr-snippet-rating-decimal").text("0.0"),t("#PRInlineRating-"+n).find("#pr-snippet-review-count").text("(No reviews)"),t("#PRInlineRating-"+n).find("#pr-snippet-star-image").addClass("pr-stars").addClass("pr-stars-small").addClass("pr-stars-0_0-sm"))}else t("#PRInlineRating-"+n).show(),t("#PRInlineRating-"+n).find(".pr-snippet-write-first-review").show(),t("#PRInlineRating-"+n).find(".pr-snippet-write-first-review").find("a.pr-snippet-link").attr("href","/write-a-review?pageId="+n+"&merchantGroupId="+a+"&merchantId="+u+"&siteId="+f+"&zipLocation="+l+"&returlUrl="+h),t("#PRInlineRating-"+n).find("#pr-snippet-rating-decimal").text("0.0"),t("#PRInlineRating-"+n).find("#pr-snippet-review-count").text("(No reviews)"),t("#PRInlineRating-"+n).find("#pr-snippet-star-image").addClass("pr-stars").addClass("pr-stars-small").addClass("pr-stars-0_0-sm")})})}var a,u,l,c,d,h,p=r.get("entity",{listName:"mozu-powerreviews-sitesettings@a0842dd",id:r.context.site}),f="",g="en_US";return t(document).ready(function(){p.then(function(e){var n=e.data,r=1==t("#prProductDetail").val(),p=1==t("#prROIWidget").val(),m=1==t("#productReviewSnippet").val(),v=1==t("#productSocialAnswerSnippet").val(),y=1==t("#productReviewDisplay").val(),b=1==t("#productSocialAnswerDisplay").val(),w=1==t("#reviewSocialAnswerTab").val();h=document.location,null!==n.locale&&(g=n.locale),a=n.merchantGrpId,u=n.merchantId,null!==n.merchantSiteId&&(f=n.merchantSiteId),l="/staticContent/pwr/"+a+"/";var x=l+"pwr/engine/js/full.js";c=l+"pwr/engine/pr_styles_review.css",d=l+"pwr/engine/merchant_styles2.css",t.getScript(x).done(function(){var e=i.Product.fromCurrent();if(r)t("head").append('<link rel="stylesheet" href="'+c+'" type="text/css" id="prBaseStylesheet">'),t("<script>").attr("type","text/javascript").text('var pr_locale="'+g+'";var pr_zip_location="'+l+'";var pr_style_sheet="/stylesheets/widgets/pr_product_styles_review_override.css"').appendTo("head"),m&&(w?POWERREVIEWS.display.snippet({write:function(e){t("#reviewSnippetProduct").append(e)}},{pr_page_id:e.id,pr_read_review:"javascript:activateTab('reviews');",pr_write_review:"/write-a-review?pageId="+e.id+"&merchantGroupId="+a+"&merchantId="+u+"&siteId="+f+"&locale="+g+"&returlUrl="+h}):POWERREVIEWS.display.snippet({write:function(e){t("#reviewSnippetProduct").append(e)}},{pr_page_id:e.id,pr_read_review:"#ReviewHeader",pr_write_review:"/write-a-review?pageId="+e.id+"&merchantGroupId="+a+"&merchantId="+u+"&siteId="+f+"&locale="+g+"&returlUrl="+h})),v&&(w?POWERREVIEWS.display.productAnswersSnippet({write:function(e){t("#socialAnswerSnippet").append(e)}},{pr_page_id:e.id,pr_ask_question:"/write-a-review?pageId="+e.id+"&merchantGroupId="+a+"&merchantId="+u+"&siteId="+f+"&locale="+g+"&returlUrl="+h+"&appName=askQuestion",pr_answer_question:"/write-a-review?pageId="+e.id+"&merchantGroupId="+a+"&merchantId="+u+"&siteId="+f+"&locale="+g+"&returlUrl="+h+"&appName=answerQuestion&questionId=@@@QUESTION_ID@@@",pr_read_qa:"javascript:activateTab('socialAnswer');"}):POWERREVIEWS.display.productAnswersSnippet({write:function(e){t("#socialAnswerSnippet").append(e)}},{pr_page_id:e.id,pr_ask_question:"/write-a-review?pageId="+e.id+"&merchantGroupId="+a+"&merchantId="+u+"&siteId="+f+"&locale="+g+"&returlUrl="+h+"&appName=askQuestion",pr_answer_question:"/write-a-review?pageId="+e.id+"&merchantGroupId="+a+"&merchantId="+u+"&siteId="+f+"&locale="+g+"&returlUrl="+h+"&appName=answerQuestion&questionId=@@@QUESTION_ID@@@",pr_read_qa:"#QAHeader"})),(y||w)&&POWERREVIEWS.display.engine({write:function(e){t("#reviewDisplayProduct").append(e)}},{pr_page_id:e.id,pr_write_review:"/write-a-review?pageId="+e.id+"&merchantGroupId="+a+"&merchantId="+u+"&siteId="+f+"&locale="+g+"&returlUrl="+h}),(b||w)&&POWERREVIEWS.display.productAnswers({write:function(e){t("#socialAnswerDisplay").append(e)}},{pr_page_id:e.id,pr_ask_question:"/write-a-review?pageId="+e.id+"&merchantGroupId="+a+"&merchantId="+u+"&siteId="+f+"&locale="+g+"&returlUrl="+h+"&appName=askQuestion",pr_answer_question:"/write-a-review?pageId="+e.id+"&merchantGroupId="+a+"&merchantId="+u+"&siteId="+f+"&locale="+g+"&returlUrl="+h+"&appName=answerQuestion&questionId=@@@QUESTION_ID@@@",pr_read_qa:"#QAHeader"});else if(p){var n="//static.powerreviews.com/t/v1/tracker.js";t.getScript(n).done(function(){var t,e,n=POWERREVIEWS.tracker.createTracker({merchantGroupId:a}),i=s.Order.fromCurrent().attributes,r="";null!==i.customerAccountId&&(r=i.customerAccountId),null!==i.fulfillmentInfo&&null!==i.fulfillmentInfo.fulfillmentContact?(t=i.fulfillmentInfo.fulfillmentContact.firstName,e=i.fulfillmentInfo.fulfillmentContact.lastNameOrSurname):(t=i.billingInfo.billingContact.firstName,e=i.billingInfo.billingContact.lastNameOrSurname);for(var o=[],l={},c=0;c<i.items.models.length;c++){var d=i.items.models[c].attributes;l.pageId=d.product.attributes.productCode,l.unitPrice=d.total,l.qty=d.quantity,l.name=d.product.attributes.name,null!==d.product.attributes.imageUrl&&(l.imageURL=d.product.attributes.imageUrl),o[c]=l}n.trackPageview("c",{merchantId:u,locale:g,merchantUserId:r,marketingOptIn:i.acceptsMarketing,userEmail:i.email,userFirstName:t,userLastName:e,orderId:i.orderNumber,orderSubtotal:i.total,orderNumberOfItems:o.length,orderItems:o}),console.log("sent order data to PowerReviews")}).fail(function(t){console.log(t)})}else o()}).fail(function(t){console.log(t)})})}),{writeProductListBoxes:function(){return p.then(o)}}}),define("modules/views-collections",["modules/jquery-mozu","underscore","hyprlive","modules/backbone-mozu","modules/models-faceting","modules/views-productlists","modules/views-paging","widgets/powerreviews"],function(t,e,n,i,r,s,o,a){function u(u){var l,c={},d=u.$body.data("mz-category"),h=u.$body.data("mz-search");h?(l=new r.SearchResult(u.data),l.setQuery(h)):l=new r.Category(u.data),d&&l.setHierarchy("categoryId",d),e.extend(c,{pagingControls:new o.PagingControls({el:u.$body.find("[data-mz-pagingcontrols]"),model:l}),pageNumbers:new o.PageNumbers({el:u.$body.find("[data-mz-pagenumbers]"),model:l}),pageSort:new o.PageSortView({el:u.$body.find("[data-mz-pagesort]"),model:l}),productList:new s.List({el:u.$body.find("[data-mz-productlist]"),model:l})}),u.$facets.length>0&&(c.facetPanel=new s.FacetingPanel({el:u.$facets,model:l})),i.history.start({pushState:!0,root:window.location.pathname});var p=new i.Router,f=!1;l.on("facetchange",function(t){f||p.navigate(t),f=!1},p),l.on("change:pageSize",l.updateFacets,l),e.invoke(c,"delegateEvents");var g=n.getThemeSetting("defaultPageSize");return p.route("*all","filter",function(){{var n=t.extend({pageSize:g},t.deparam()),i={};l.lastRequest}n.startIndex||(i.resetIndex=!0),l.hierarchyField&&n[l.hierarchyField]!==l.hierarchyValue&&(l.setHierarchy(l.hierarchyField,n[l.hierarchyField]||d),i.force=!0),l.set(e.pick(n,"pageSize","startIndex","facetValueFilter","sortBy"),{silent:!0}),f=!0,l.updateFacets(i)}),c.productList.on("render",a.writeProductListBoxes),c}return{createFacetedCollectionViews:u}});